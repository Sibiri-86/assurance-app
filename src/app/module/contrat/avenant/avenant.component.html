<div class="p-grid">
    <div class="p-col-12">
        <p-toast></p-toast>
        <div class="card">
            <p-toolbar styleClass="p-mb-4">
                <div class="p-col-12">
                    <p-toast></p-toast>
                    <div class="card">
                        <ng-template pTemplate="left">
                            <button pButton pRipple label="Ajouter" icon="pi pi-plus"
                                    class="p-button-success p-mr-2 p-mb-2"
                                    (click)="addPolice()"></button>
                            <button pButton pRipple label="Supprimer" icon="pi pi-trash p-mr-2"
                                    class="p-button-danger p-mb-2"
                                    (click)="deleteSelectedPolice()"
                                    [disabled]="!selectedGarants || !selectedGarants.length"></button>

                            <div class="p-col p-mr-2 p-mb-2">
                                <p-dropdown inputId="typeAvenant" [filter]="true" showClear="true"
                                            [options]="avenantList"
                                            dataKey="id" [style]="{'width':'100%'}"
                                            placeholder="Selectionnez le type avenant"
                                            (onChange)="changeAvenant($event)" optionLabel="libelle"></p-dropdown>
                            </div>
                            <div class="p-col p-mr-2 p-mb-2">
                                <p-dropdown inputId="polices" [filter]="true" showClear="true" [options]="policeList"
                                            dataKey="id" [style]="{'width':'100%'}" placeholder="Selectionnez la police"
                                            (onChange)="loadHistoriqueAvenant($event)"
                                            optionLabel="numero"></p-dropdown>
                            </div>
                        </ng-template>
                    </div>
                </div>
            </p-toolbar>

            <p-table #dt [value]="policeList" [columns]="cols" [rows]="10" [paginator]="true"
                     [globalFilterFields]="['numero','garant.nom','intermediaire.nom','numero','taux.taux']"
                     [rowHover]="true" dataKey="id" styleClass="p-datatable-customers"
                     currentPageReportTemplate="affichage {first} à {last} de {totalRecords} enregistrement"
                     [showCurrentPageReport]="true">
                <ng-template pTemplate="caption">
                    <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                        <h5 class="p-m-0"></h5>
                        <span class="p-input-icon-left">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                               placeholder="Search..."/>
                        </span>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 3rem">
                            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                        </th>
                        <th pSortableColumn="numero" style="width: 12rem">Numero
                            <p-sortIcon field="numero"></p-sortIcon>
                        </th>
                        <th pSortableColumn="nom" style="width: 15rem">Souscripteur
                            <p-sortIcon field="nom"></p-sortIcon>
                        </th>
                        <th pSortableColumn="taux" style="width: 7rem">Taux
                            <p-sortIcon field="taux.taux"></p-sortIcon>
                        </th>
                        <!--<th pSortableColumn="territorialite" style="width: 14rem">Territorialite
                            <p-sortIcon field="territorialite.libelle"></p-sortIcon>
                        </th>-->
                        <th pSortableColumn="duree" style="width: 7rem">Duree
                            <p-sortIcon field="duree"></p-sortIcon>
                        </th>
                        <th pSortableColumn="dateEffet" style="width: 14rem">Date effet
                            <p-sortIcon field="dateEffet"></p-sortIcon>
                        </th>
                        <th pSortableColumn="dateEcheance" style="width: 14rem">Date écheance
                            <p-sortIcon field="dateEcheance"></p-sortIcon>
                        </th>
                        <th></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-police>
                    <tr>
                        <td>
                            <p-tableCheckbox [value]="police"></p-tableCheckbox>
                        </td>

                        <td><span class="p-column-title">{{police.numero}}</span>
                        </td>
                        <td><span class="p-column-title">{{police.nom}}</span>
                        </td>
                        <td><span class="p-column-title">{{police.taux.taux}}</span>
                        </td>
                        <!--<td>
                            <span class="p-column-title" *ngFor="let t of police.territorialite">
                                {{t.libelle}}
                            </span>
                        </td>-->
                        <td><span class="p-column-title">{{police.duree}}</span>
                        </td>
                        <td><span class="p-column-title">{{police.dateEffet | formatTableValue : 'date'}}</span>
                        </td>
                        <td>
                            <span class="p-column-title">{{police.dateEcheance | formatTableValue : 'date'}}</span>
                        </td>
                        <td>
                            <button *ngIf="typeAvenantSelected==='modification'" pButton pRipple icon="pi pi-pencil"
                                    pTooltip="editer" class="p-button-rounded p-button-success p-mr-2"
                                    (click)="editPolice(police)"></button>
                            <button *ngIf="typeAvenantSelected==='modification'" pButton pRipple icon="pi pi-trash"
                                    pTooltip="Supprimer" class="p-button-rounded p-button-warning p-mr-2"
                                    (click)="deletePolice(police)"></button>
                            <button *ngIf="typeAvenantSelected==='incorporation'" pButton pRipple icon="pi pi-angle-up"
                                    pTooltip="voir groupe" class="p-button-rounded p-button-info p-mr-2"
                                    (click)="voirGroupe(police)"></button>
                            <button pButton pRipple icon="pi pi-eye" pTooltip="voir details"
                                    class="p-button-rounded p-button-info" (click)="onRowSelectPolice(police)"></button>
                            <!--button pButton  pRipple icon="pi pi-times" pTooltip="Invalider police" class="p-button-rounded p-button-info" (click)="invaliderPolice(police)"></button-->
                            <button pButton pRipple icon="pi pi-reply" pTooltip="Rétrograder"
                                    class="p-button-rounded p-button-warning p-ml-2 p-mr-2"
                                    (click)="deValiderPolice(police)"></button>
                            <!-- <button pButton pRipple icon="pi pi-list" pTooltip="Liste actualisée" 
                                    class="p-button-rounded p-button-info p-mr-2" (click)="loadActualList(police)"></button> -->
                                    <button pButton pRipple icon="pi pi-eye" pTooltip="voir statistique"
                                    class="p-button-rounded p-button-info p-mr-2" (click)="getStatistique(police)"></button>
                            <button pButton pRipple icon="pi pi-search p-mr-2" pTooltip="voir contrat"
                            class="p-button-rounded p-button-info" (click)="voirContrat(police); loadGoupeByPolice1(police); loadActualListByContrat(police)"></button>
                            <!-- <p-splitButton label="Avenants" icon="pi pi-plus" [model]="typeActions" class="p-ml-2" [disabled]="police.historiqueAvenantListWithoutActiveList?.length > 0"
                                           (onDropdownClick)="policeItem = police; setPolice(police); loadGoupeByPolice()"></p-splitButton> -->
                            <!-- SPlit sans la fonction setPolice -->
                            <p-splitButton label="Avenants" icon="pi pi-plus" [model]="typeActions" class="p-ml-2" [disabled]="police.historiqueAvenantListWithoutActiveList?.length > 0"
                                (onDropdownClick)="policeItem = police; loadGoupeByPolice() ;setPolice(police)">
                            </p-splitButton>


                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="summary">
                    <div class="p-d-flex p-ai-center p-jc-between">
                        {{policeList ? policeList.length : 0 }} police(s).
                    </div>
                </ng-template>
            </p-table>
        </div>

        <p-dialog [(visible)]="displaySousActe" header="Sous-acte" [modal]="true" styleClass="p-fluid"
                  [style]="{width: '1200px'}">
            <div class="card">
                <p-toolbar styleClass="p-mb-4">
                    <ng-template pTemplate="left">
                        <button pButton pRipple label="Valider" icon="pi pi-check" (click)="addSousActe()"
                                class="p-button-success p-mr-2 p-mb-2"></button>
                    </ng-template>
                </p-toolbar>

                <h5></h5>
                <p-table #dtSousActe [value]="plafondSousActe" dataKey="" editMode="row">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Sous acte</th>
                            <th>Montant</th>
                            <th>Periode</th>
                            <th>Nombre acte</th>
                            <th>Taux</th>
                            <th>Date effet</th>
                            <th style="width:8em"></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                        <tr [pEditableRow]="rowData">
                            <td>
                                {{rowData.sousActe.libelle}}
                            </td>

                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="rowData.montantPlafond" required>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.montantPlafond}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-dropdown [options]="dimensionPeriodeList"
                                                    [(ngModel)]="rowData.dimensionPeriode" optionLabel="libelle"
                                                    placeholder="Select Make"
                                                    [style]="{'width':'100%'}"></p-dropdown>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dimensionPeriode?.libelle}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="rowData.nombre" required>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.nombre}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-dropdown [options]="tauxList" [(ngModel)]="rowData.taux" optionLabel="taux"
                                                    placeholder="Select Make"
                                                    [style]="{'width':'100%'}"></p-dropdown>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.taux.taux}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-calendar [showIcon]="true" [(ngModel)]="rowData.dateEffet"
                                                    dateFormat="dd/mm/yy" inputId="calendar"
                                                    appendTo="body"></p-calendar>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dateEffet}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td style="text-align:center">
                                <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil"
                                        class="ui-button-info" (click)="onRowEditInitPlafondSousActe(rowData)"></button>
                                <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check"
                                        class="ui-button-success" style="margin-right: .5em"
                                        (click)="onRowEditSavePlafondSousActe(rowData)"></button>
                                <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times"
                                        class="ui-button-danger"
                                        (click)="onRowEditCancelPlafondSousActe(rowData, ri)"></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </p-dialog>


        <p-dialog [(visible)]="displayParametragePlafond" header="Parametrage plafond" [modal]="true"
                  styleClass="p-fluid" [style]="{width: '1200px'}">
            <div class="card">
                <h5></h5>

                <form [formGroup]="plafondForm">
                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-col-4">
                            <label class="p-mb-3">Domaine d'application</label>
                            <div class="p-field-radiobutton p-col-6" *ngFor="let qualite of qualiteAssureList">
                                <p-radioButton [id]="qualite.id" name="domaine" [value]="qualite"
                                               formControlName="domaine"></p-radioButton>
                                <label [for]="qualite.id">{{qualite.libelle}}</label>
                            </div>
                        </div>
                        <div class="p-field p-col-4">
                            <label for="primeFamille">Plafond globale annuelle par personne</label>
                            <input id="primeFamille" type="number" pInputText formControlName="plafondAnnuellePersonne">
                        </div>
                        <div class="p-field p-col-4">
                            <label for="montantPrimeEnfant">Plafond globale par famille</label>
                            <input id="montantPrimeEnfant" type="number" pInputText
                                   formControlName="plafondAnnuelleFamille">
                        </div>
                    </div>
                </form>

                <br/>
                <hr/>
                <p-table #dt [value]="plafondFamilleActe" dataKey="" editMode="row">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Famille acte</th>
                            <th>Montant</th>
                            <th>Periode</th>
                            <th>Nombre acte</th>
                            <th>Taux</th>
                            <th>Date effet</th>
                            <th style="width:8em"></th>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                        <tr [pEditableRow]="rowData">
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-dropdown [options]="garanties" [(ngModel)]="rowData.garantie"
                                                    optionLabel="libelle" placeholder="Select Make"
                                                    [style]="{'width':'100%'}"
                                                    (onChange)="changeGarantie($event, ri)"></p-dropdown>
                                    </ng-template>
                                    <ng-template pTemplate="output" *ngIf="rowData.garantie">
                                        {{rowData.garantie.libelle}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>

                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="rowData.montantPlafond" required>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.montantPlafond}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-dropdown [options]="dimensionPeriodeList"
                                                    [(ngModel)]="rowData.dimensionPeriode" optionLabel="libelle"
                                                    placeholder="Select Make"
                                                    [style]="{'width':'100%'}"></p-dropdown>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dimensionPeriode.libelle}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="rowData.nombre" required>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.nombre}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-dropdown [options]="tauxList" [(ngModel)]="rowData.taux" optionLabel="taux"
                                                    placeholder="Select Make"
                                                    [style]="{'width':'100%'}"></p-dropdown>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.taux.taux}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-calendar [showIcon]="true" [(ngModel)]="rowData.dateEffet"
                                                    dateFormat="dd/mm/yy" inputId="calendar"
                                                    appendTo="body"></p-calendar>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dateEffet}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td style="text-align:center">
                                <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil"
                                        class="ui-button-info p-mr-2" (click)="onRowEditInit(rowData)"></button>
                                <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check"
                                        class="ui-button-success p-mr-2" style="margin-right: .5em"
                                        (click)="onRowEditSave(rowData)"></button>
                                <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times"
                                        class="ui-button-danger p-mr-2" (click)="onRowEditCancel(rowData, ri)"></button>
                                <button *ngIf="!editing" pButton type="button" pCancelEditableRow
                                        icon="pi pi-arrow-circle-down" class="ui-button-danger p-mr-2"
                                        (click)="addFamilleActe(rowData, ri)"></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>


                <p-table #dtActe [value]="plafondActe" dataKey="" editMode="row">
                    <ng-template pTemplate="header">
                        <tr>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th style="width:8em"></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                        <tr [pEditableRow]="rowData">
                            <td>
                                {{rowData.acte.libelle}}
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="rowData.montantPlafond" required>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.montantPlafond}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-dropdown [options]="dimensionPeriodeList"
                                                    [(ngModel)]="rowData.dimensionPeriode" optionLabel="libelle"
                                                    placeholder="Select Make"
                                                    [style]="{'width':'100%'}"></p-dropdown>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dimensionPeriode?.libelle}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="rowData.nombre" required>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.nombre}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>

                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-dropdown [options]="tauxList" [(ngModel)]="rowData.taux" optionLabel="taux"
                                                    placeholder="Select Make"
                                                    [style]="{'width':'100%'}"></p-dropdown>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.taux?.taux}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>

                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <p-calendar [showIcon]="true" [(ngModel)]="rowData.dateEffet"
                                                    dateFormat="dd/mm/yy" inputId="calendar"
                                                    appendTo="body"></p-calendar>
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dateEffet}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>

                            <td style="text-align:center">
                                <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil"
                                        class="ui-button-info p-mr-2"
                                        (click)="onRowEditInitPlafondActe(rowData)"></button>
                                <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check"
                                        class="ui-button-success p-mr-2" style="margin-right: .5em"
                                        (click)="onRowEditSavePlafondActe(rowData)"></button>
                                <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times"
                                        class="ui-button-danger p-mr-2"
                                        (click)="onRowEditCancelPlafondActe(rowData, ri)"></button>
                                <button *ngIf="!editing" pButton type="button" pCancelEditableRow
                                        icon="pi pi-chevron-right" class="ui-button-danger p-mr-2"
                                        (click)="getSousActe(rowData, ri)"></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
                <br/>
                <hr/>
                <p-toolbar styleClass="p-mb-4">
                    <ng-template pTemplate="right">
                        <button pButton pRipple label="Valider" icon="pi pi-check" (click)="validerPlafond()"
                                class="p-button-success p-mr-2 p-mb-2"></button>
                        <!--
                        <button pButton pRipple label="Consulter" icon="pi pi-plus" (click)="addSousActe()" class="p-button-success p-mr-2 p-mb-2" ></button>
                        -->
                    </ng-template>
                </p-toolbar>

            </div>
        </p-dialog>


        <p-dialog [(visible)]="displayDialogFormAddGroupe" header="Ajouter" [modal]="true" styleClass="p-fluid"
                  [style]="{'width':'1300px'}">
            <ng-template pTemplate="content">

                <div class="p-formgrid p-grid p-justify-center">
                    <div class="card">
                        <form [formGroup]="groupeForm">
                            <h5></h5>
                            <div class="p-fluid p-formgrid p-grid">

                                <div class="p-field p-col">
                                    <label for="firstname2">Libelle</label>
                                    <input id="nom" type="text" required formControlName="libelle" pInputText>
                                    <app-entity-validation [entityValidations]="entityValidations"
                                                           [formGroup]="groupeForm" [entityField]="'nom'">
                                    </app-entity-validation>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Taux de couverture</label>
                                    <p-dropdown dataKey="id" inputId="taux" [filter]="true" showClear="true"
                                                [options]="tauxList" formControlName="taux" placeholder="Select"
                                                optionLabel="taux"></p-dropdown>
                                    <app-entity-validation [entityValidations]="entityValidations"
                                                           [formGroup]="groupeForm" [entityField]="'taux'">
                                    </app-entity-validation>
                                </div>

                                <div class="p-field p-col">
                                    <label for="firstname2">Territorialité</label>
                                    <p-dropdown dataKey="id" inputId="territorialite" [filter]="true" showClear="true"
                                                [options]="territorialiteList" formControlName="territorialite"
                                                placeholder="Select" optionLabel="libelle"></p-dropdown>
                                    <app-entity-validation [entityValidations]="entityValidations"
                                                           [formGroup]="groupeForm" [entityField]="'territorialite'">
                                    </app-entity-validation>
                                </div>
                            </div>

                            <div class="p-fluid p-formgrid p-grid">

                                <div class="p-field p-col">
                                    <label for="dateEffet">Date effet</label>
                                    <p-calendar [(ngModel)]="dateEffet" [showIcon]="true" dateFormat="dd/mm/yy"
                                                inputId="calendar" formControlName="dateEffet"
                                                appendTo="body"></p-calendar>
                                    <app-entity-validation [entityValidations]="entityValidations"
                                                           [formGroup]="groupeForm" [entityField]="'dateEffet'">
                                    </app-entity-validation>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Durée en mois</label>
                                    <input id="lastname2" type="number"
                                           (input)="onRefreshDateEcheanceForGroupe($event.target.value)"
                                           formControlName="duree" pInputText>
                                    <app-entity-validation [entityValidations]="entityValidations"
                                                           [formGroup]="groupeForm" [entityField]="'duree'">
                                    </app-entity-validation>
                                </div>

                                <div class="p-field p-col-4">
                                    <label for="lastname2">Date écheance</label>
                                    <p-calendar [disabled]="true" [showIcon]="true" dateFormat="dd/mm/yy"
                                                inputId="calendar" formControlName="dateEcheance"
                                                appendTo="body"></p-calendar>
                                    <app-entity-validation [entityValidations]="entityValidations"
                                                           [formGroup]="groupeForm" [entityField]="'dateEcheance'">
                                    </app-entity-validation>
                                </div>
                            </div>
                        </form>


                        <!--
                        <p-tabPanel [disabled]="groupeForm?.invalid" header="Prestations" leftIcon="">
                                <div class="card">
                                <h5></h5>
                                    <div class="p-field">
                                    <label for="typePrime">Type de prime</label>
                                    <p-dropdown dataKey="id" inputId="typePrime" [filter]="true" showClear="true" [options]="typePrimeList" [(ngModel)]="selectedTypePrime" optionLabel="libelle" (onChange)="changePrime($event)"></p-dropdown>
                                    </div>
                                <form [formGroup]="primeForm">
                                    <div class="p-field" *ngIf="selectedTypePrime.libelle==='famille'">
                                        <label for="primeFamille">Montant prime famille</label>
                                        <input id="primeFamille" type="number" pInputText formControlName="primeFamille">
                                    </div>

                                    <div class="p-field" *ngIf="selectedTypePrime.libelle==='adulte et enfant'">
                                        <label for="montantPrimeEnfant">Montant prime enfant</label>
                                        <input id="montantPrimeEnfant" type="number" pInputText formControlName="primeEnfant">
                                    </div>

                                    <div class="p-field" *ngIf="selectedTypePrime.libelle==='adulte et enfant'">
                                        <label for="primeAdulte">Montant prime adulte</label>
                                        <input id="primeAdulte" type="number" pInputText formControlName="primeAdulte">
                                    </div>

                                    <div class="p-field" *ngIf="selectedTypePrime.libelle==='employe,conjoint,enfant'">
                                        <label for="primeEmploye">Montant prime employe</label>
                                        <input id="primeEmploye" type="number" pInputText formControlName="primeEmploye">
                                    </div>

                                    <div class="p-field" *ngIf="selectedTypePrime.libelle==='employe,conjoint,enfant'">
                                        <label for="primeConjoint">Montant prime conjoint</label>
                                        <input id="primeConjoint" type="number" pInputText formControlName="primeConjoint">
                                    </div>

                                    <div class="p-field" *ngIf="selectedTypePrime.libelle==='employe,conjoint,enfant'">
                                        <label for="primeEnfant">Montant prime enfant</label>
                                        <input id="primeEnfant" type="number" pInputText formControlName="primeEnfant">
                                    </div>
                                </form>

                            </div>
                        </p-tabPanel>
                        -->
                        <br/>
                        <h6>Parametrage prime</h6>
                        <hr/>
                        <form [formGroup]="primeForm">
                            <h5></h5>
                            <div class="p-fluid p-formgrid p-grid">

                                <div class="p-field p-col">
                                    <label for="typePrime">Type de prime</label>
                                    <p-dropdown dataKey="id" inputId="typePrime" [filter]="true" showClear="true"
                                                [options]="typePrimeList" [(ngModel)]="selectedTypePrime"
                                                formControlName="prime" optionLabel="libelle"
                                                (onChange)="changePrime($event)"></p-dropdown>
                                </div>

                                <div class="p-field p-col">
                                    <label for="primeFamille">Montant prime famille <span
                                            [ngClass]="{'requiredClass': selectedTypePrime.libelle==='famille'}"></span></label>
                                    <input id="primeFamille" type="number" pInputText formControlName="primeFamille">
                                </div>

                                <div class="p-field p-col">
                                    <label for="montantPrimeEnfant">Montant prime enfant <span
                                            [ngClass]="{'requiredClass': selectedTypePrime.libelle==='adulte et enfant'}"></span></label>
                                    <input id="montantPrimeEnfant" type="number" pInputText
                                           formControlName="primeEnfant">
                                </div>

                            </div>

                            <div class="p-fluid p-formgrid p-grid">
                                <div class="p-field p-col">
                                    <label for="primeAdulte">Montant prime adulte <span
                                            [ngClass]="{'requiredClass': selectedTypePrime.libelle==='adulte et enfant'}"></span></label>
                                    <input id="primeAdulte" type="number" pInputText formControlName="primeAdulte">
                                </div>

                                <div class="p-field p-col">
                                    <label for="primeEmploye">Montant prime employe <span
                                            [ngClass]="{'requiredClass': selectedTypePrime.libelle==='employe,conjoint,enfant'}"></span></label>
                                    <input id="primeEmploye" type="number" pInputText formControlName="primeEmploye">
                                </div>

                                <div class="p-field p-col">
                                    <label for="primeConjoint">Montant prime conjoint <span
                                            [ngClass]="{'requiredClass': selectedTypePrime.libelle==='employe,conjoint,enfant'}"></span></label>
                                    <input id="primeConjoint" type="number" pInputText formControlName="primeConjoint">
                                </div>
                            </div>

                            <div class="p-fluid p-formgrid p-grid">

                                <div class="p-field p-col-4">
                                    <label for="primeEnfant">Montant prime enfant <span
                                            [ngClass]="{'requiredClass': selectedTypePrime.libelle==='employe,conjoint,enfant'}"></span></label>
                                    <input id="primeEnfant" type="number" pInputText formControlName="primeEnfant">
                                </div>

                            </div>
                        </form>
                        <br/>
                        <h6>Information adhérent</h6>
                        <hr/>
                        <form [formGroup]="adherentForm">
                            <h5></h5>
                            <div class="p-fluid p-formgrid p-grid">
                                <div class="p-field p-col">
                                    <label for="firstname2">Nom</label>
                                    <input id="nom" type="text" required formControlName="nom" pInputText>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Prenom</label>
                                    <input id="lastname2" type="text" formControlName="prenom" pInputText>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Telephone</label>
                                    <input id="lastname2" type="text" formControlName="numeroTelephone" pInputText>
                                </div>
                            </div>

                            <div class="p-fluid p-formgrid p-grid">
                                <div class="p-field p-col">
                                    <label for="firstname2">Adresse Email</label>
                                    <input id="firstname2" type="text" formControlName="adresseEmail" pInputText>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Adresse</label>
                                    <input id="lastname2" type="text" formControlName="adresse" pInputText>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Reference bancaire</label>
                                    <input id="lastname2" type="text" formControlName="referenceBancaire" pInputText>
                                </div>
                            </div>

                            <div class="p-fluid p-formgrid p-grid">

                                <div class="p-field p-col">
                                    <label for="lastname2">Date de naissance</label>
                                    <p-calendar [showIcon]="true" formControlName="dateNaissance" dateFormat="dd/mm/yy"
                                                inputId="calendar" appendTo="body"></p-calendar>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Lieu de naissance</label>
                                    <input id="lastname2" type="text" formControlName="lieuNaissance" pInputText>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Date incorporation</label>
                                    <p-calendar [showIcon]="true" formControlName="dateIncorporation"
                                                dateFormat="dd/mm/yy" inputId="calendar" appendTo="body"></p-calendar>
                                </div>
                            </div>

                            <div class="p-fluid p-formgrid p-grid">

                                <div class="p-field p-col">
                                    <label for="lastname2">Date entrée</label>
                                    <p-calendar [showIcon]="true" formControlName="dateEntree" dateFormat="dd/mm/yy"
                                                inputId="calendar" appendTo="body"></p-calendar>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Genre</label>
                                    <p-dropdown inputId="genre" dataKey="id" [filter]="true" showClear="true"
                                                [options]="genreList" formControlName="genre" placeholder="Select"
                                                optionLabel="libelle"></p-dropdown>
                                </div>

                                <div class="p-field p-col">
                                    <label for="lastname2">Profession</label>
                                    <p-dropdown inputId="profession" dataKey="id" [filter]="true" showClear="true"
                                                [options]="professionList" formControlName="profession"
                                                placeholder="Select" optionLabel="libelle"></p-dropdown>
                                </div>
                            </div>

                            <div class="p-fluid p-formgrid p-grid">
                                <div class="p-field p-col-4">
                                    <label for="lastname2">Qualite assuré</label>
                                    <p-dropdown inputId="qualiteAssure" dataKey="id" [filter]="true" showClear="true"
                                                [options]="qualiteAssureList" formControlName="qualiteAssure"
                                                placeholder="Select" optionLabel="libelle"></p-dropdown>
                                </div>
                                <div class="p-field p-col-4">
                                    <label for="lastname2">Matricule</label>
                                    <input id="lastname2" type="text" formControlName="matricule" pInputText>
                                </div>
                            </div>

                        </form>
                        <br/>
                        <hr/>
                        <h6>Famille adherent</h6>
                        <p-toolbar styleClass="p-mb-4">
                            <ng-template pTemplate="left">
                                <button pButton pRipple label="Ajouter" icon="pi pi-plus" pAddRow
                                        [table]="dtFamilleAdherent" [newRow]="newRowFamilleAdherent()"
                                        class="p-button-success p-mr-2 p-mb-2"></button>
                            </ng-template>
                        </p-toolbar>

                        <p-table #dtFamilleAdherent [value]="adherentFamilleList" dataKey="" editMode="row">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>Nom</th>
                                    <th>Prenom</th>
                                    <th>Telephone</th>
                                    <th>Date de naissance</th>
                                    <th>Date incorporation</th>
                                    <th>Date entrée</th>
                                    <th>Genre</th>
                                    <th>Qualite assuré</th>
                                    <th style="width:8em"></th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                                <tr [pEditableRow]="rowData">
                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <input pInputText type="text" [(ngModel)]="rowData.nom" required>
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.nom}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <input pInputText type="text" [(ngModel)]="rowData.prenom" required>
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.prenom}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <input pInputText type="text" [(ngModel)]="rowData.telephone" required>
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.telephone}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <p-calendar [(ngModel)]="rowData.dateNaissance" [showIcon]="true"
                                                            dateFormat="dd/mm/yy" inputId="calendar"
                                                            appendTo="body"></p-calendar>
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.dateNaissance}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <p-calendar [(ngModel)]="rowData.dateIncorporation" [showIcon]="true"
                                                            dateFormat="dd/mm/yy" inputId="calendar"
                                                            appendTo="body"></p-calendar>
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.dateIncorporation}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <p-calendar [(ngModel)]="rowData.dateEntree" [showIcon]="true"
                                                            dateFormat="dd/mm/yy" inputId="calendar"
                                                            appendTo="body"></p-calendar>
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.dateEntree}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <p-dropdown [options]="genreList" [(ngModel)]="rowData.genre"
                                                            optionLabel="libelle" placeholder="Select Make"
                                                            [style]="{'width':'100%'}"></p-dropdown>
                                            </ng-template>
                                            <ng-template pTemplate="output" *ngIf="rowData.genre">
                                                {{rowData.genre.libelle}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td>
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <p-dropdown [options]="qualiteAssureList"
                                                            [(ngModel)]="rowData.qualiteAssure" optionLabel="libelle"
                                                            placeholder="Select Make"
                                                            [style]="{'width':'100%'}"></p-dropdown>
                                            </ng-template>
                                            <ng-template pTemplate="output" *ngIf="rowData.qualiteAssure">
                                                {{rowData.qualiteAssure.libelle}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>

                                    <td style="text-align:center">
                                        <button *ngIf="!editing" pButton type="button" pInitEditableRow
                                                icon="pi pi-pencil" class="ui-button-info"
                                                (click)="onRowEditInitAdherentFamille(rowData, ri)"></button>
                                        <button *ngIf="editing" pButton type="button" pSaveEditableRow
                                                icon="pi pi-check" class="ui-button-success" style="margin-right: .5em"
                                                (click)="onRowEditSaveAdherentFamille(rowData, ri)"></button>
                                        <button *ngIf="editing" pButton type="button" pCancelEditableRow
                                                icon="pi pi-times" class="ui-button-danger"
                                                (click)="onRowEditCancelAdherentFamille(rowData, ri)"></button>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>

                <!--
                              <div class="card">
                                      <h5></h5>

                                      <p-toolbar styleClass="p-mb-4">
                                      <ng-template pTemplate="left">
                                      <button pButton type="button" icon="pi pi-plus" class="p-button-text" [label]="'Ajouter'"
                                           pAddRow [table]="dt" [newRow]="newRow()"></button>
                                      </ng-template>
                                      </p-toolbar>


                                      <p-toolbar styleClass="p-mb-4">
                                          <ng-template pTemplate="left">
                                              <button pButton pRipple label="Valider" icon="pi pi-plus" (click)="addSousActe()" class="p-button-success p-mr-2 p-mb-2" ></button>
                                              <button pButton pRipple label="Consulter" icon="pi pi-plus" (click)="addSousActe()" class="p-button-success p-mr-2 p-mb-2" ></button>
                                          </ng-template>
                                      </p-toolbar>

                                      <p-table #dt [value]="plafondFamilleActe" dataKey="" editMode="row">
                                          <ng-template pTemplate="header">
                                              <tr>
                                                  <th>Famille acte</th>
                                                  <th>Montant</th>
                                                  <th>Periode</th>
                                                  <th>Nombre acte</th>
                                                  <th>Date effet</th>
                                                  <th style="width:8em"></th>
                                              </tr>
                                          </ng-template>

                                          <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                                              <tr [pEditableRow]="rowData">
                                                  <td>
                                                      <p-cellEditor>
                                                        <ng-template pTemplate="input">
                                                            <p-dropdown [options]="garanties" [(ngModel)]="rowData.garantie" optionLabel="libelle" placeholder="Select Make"
                                                            [style]="{'width':'100%'}" (onChange)="changeGarantie($event, ri)"></p-dropdown>
                                                        </ng-template>
                                                        <ng-template pTemplate="output" *ngIf="rowData.garantie">
                                                            {{rowData.garantie.libelle}}
                                                        </ng-template>
                                                    </p-cellEditor>
                                                  </td>

                                                  <td>
                                                    <p-cellEditor>
                                                      <ng-template pTemplate="input">
                                                          <input pInputText type="text" [(ngModel)]="rowData.montantPlafond" required>
                                                      </ng-template>
                                                      <ng-template pTemplate="output">
                                                          {{rowData.montantPlafond}}
                                                      </ng-template>
                                                  </p-cellEditor>
                                                  </td>
                                                  <td>
                                                      <p-cellEditor>
                                                          <ng-template pTemplate="input">
                                                              <p-dropdown [options]="dimensionPeriodeList" [(ngModel)]="rowData.dimensionPeriode" optionLabel="libelle" placeholder="Select Make"
                                                              [style]="{'width':'100%'}"></p-dropdown>
                                                          </ng-template>
                                                          <ng-template pTemplate="output">
                                                              {{rowData.dimensionPeriode.libelle}}
                                                          </ng-template>
                                                    </p-cellEditor>
                                                  </td>
                                                  <td>
                                                      <p-cellEditor>
                                                        <ng-template pTemplate="input">
                                                            <input pInputText type="text" [(ngModel)]="rowData.nombre" required>
                                                        </ng-template>
                                                        <ng-template pTemplate="output">
                                                            {{rowData.nombre}}
                                                        </ng-template>
                                                    </p-cellEditor>
                                                  </td>
                                                  <td>
                                                      <p-cellEditor>
                                                        <ng-template pTemplate="input">
                                                            <p-calendar  [showIcon]="true" [(ngModel)]="rowData.dateEffet"  dateFormat="dd/mm/yy" inputId="calendar" appendTo="body"></p-calendar>
                                                        </ng-template>
                                                        <ng-template pTemplate="output">
                                                            {{rowData.dateEffet}}
                                                        </ng-template>
                                                    </p-cellEditor>
                                                  </td>
                                                    <td style="text-align:center">
                                                      <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info p-mr-2" (click)="onRowEditInit(rowData)"></button>
                                                      <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check" class="ui-button-success p-mr-2" style="margin-right: .5em" (click)="onRowEditSave(rowData)"></button>
                                                      <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger p-mr-2" (click)="onRowEditCancel(rowData, ri)"></button>
                                                      <button *ngIf="!editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger p-mr-2" (click)="addFamilleActe(rowData, ri)"></button>
                                                  </td>
                                              </tr>
                                          </ng-template>
                                      </p-table>


                                      <p-table #dtActe [value]="plafondActe" dataKey="" editMode="row">
                                          <ng-template pTemplate="header">
                                              <tr>
                                                  <th></th>
                                                  <th></th>
                                                  <th></th>
                                                  <th></th>
                                                  <th></th>
                                                  <th style="width:8em"></th>
                                              </tr>
                                          </ng-template>
                                          <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                                              <tr [pEditableRow]="rowData">
                                                  <td>
                                                      {{rowData.acte.libelle}}
                                                      </td>
                                                  <td>
                                                    <p-cellEditor>
                                                      <ng-template pTemplate="input">
                                                          <input pInputText type="text" [(ngModel)]="rowData.montantPlafond" required>
                                                      </ng-template>
                                                      <ng-template pTemplate="output">
                                                          {{rowData.montantPlafond}}
                                                      </ng-template>
                                                  </p-cellEditor>
                                                  </td>
                                                  <td>
                                                      <p-cellEditor>
                                                        <ng-template pTemplate="input">
                                                            <p-dropdown [options]="dimensionPeriodeList" [(ngModel)]="rowData.dimensionPeriode" optionLabel="libelle" placeholder="Select Make"
                                                            [style]="{'width':'100%'}"></p-dropdown>
                                                        </ng-template>
                                                        <ng-template pTemplate="output" *ngIf="rowData.dimensionPeriode">
                                                            {{rowData.dimensionPeriode.libelle}}
                                                        </ng-template>
                                                    </p-cellEditor>
                                                  </td>
                                                  <td>
                                                      <p-cellEditor>
                                                        <ng-template pTemplate="input">
                                                            <input pInputText type="text" [(ngModel)]="rowData.nombre" required>
                                                        </ng-template>
                                                        <ng-template pTemplate="output">
                                                            {{rowData.nombre}}
                                                        </ng-template>
                                                    </p-cellEditor>
                                                  </td>
                                                  <td>
                                                      <p-cellEditor>
                                                        <ng-template pTemplate="input">
                                                            <p-calendar  [showIcon]="true" [(ngModel)]="rowData.dateEffet"  dateFormat="dd/mm/yy" inputId="calendar" appendTo="body"></p-calendar>
                                                        </ng-template>
                                                        <ng-template pTemplate="output">
                                                            {{rowData.dateEffet}}
                                                        </ng-template>
                                                    </p-cellEditor>
                                                  </td>
                                                    <td style="text-align:center">
                                                      <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info p-mr-2" (click)="onRowEditInitPlafondActe(rowData)"></button>
                                                      <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check" class="ui-button-success p-mr-2" style="margin-right: .5em" (click)="onRowEditSavePlafondActe(rowData)"></button>
                                                      <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger p-mr-2" (click)="onRowEditCancelPlafondActe(rowData, ri)"></button>
                                                      <button *ngIf="!editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger p-mr-2" (click)="getSousActe(rowData, ri)"></button>
                                                  </td>
                                              </tr>
                                          </ng-template>
                                      </p-table>

                                     </div>


                          <div class="card">
                                      <h5>Parametrage du plafond acte</h5>
                                      <p-toolbar styleClass="p-mb-4">
                                      <ng-template pTemplate="left">
                                      <button pButton type="button" icon="pi pi-plus" class="p-button-text" [label]="'Ajouter'"
                                       pAddRow [table]="dtActe" [newRow]="newRowPlafondActe()"></button>
                                      </ng-template>
                                      </p-toolbar>
                                  </div>
                          -->
                <br/>
                <div class="p-grid p-justify-between">
                    <div>
                        <button pButton pRipple label="Quitter" icon="pi pi-times" (click)="annulerSaisie()"></button>
                    </div>
                    <div>
                        <button [disabled]="(adherentForm?.invalid || primeForm?.invalid || groupeForm?.invalid)"
                                pButton pRipple label="Valider" icon="pi pi-check" (click)="onCreateGroupe()"></button>
                    </div>
                </div>
                <br/>
            </ng-template>
        </p-dialog>

        <!--voir les groupes -->
        <!--
                <p-dialog [(visible)]="displayDialogFormGroupe" header="Groupe" [modal]="true" styleClass="p-fluid"
                          [style]="{'width':'1100px'}">
                    <ng-template pTemplate="content">
                        <div class="">
                            <div class="card">
                                <p-toolbar styleClass="p-mb-4">
                                    <ng-template pTemplate="left">
                                        <button pButton pRipple label="Ajouter" icon="pi pi-plus"
                                                class="p-button-success p-mr-2 p-mb-2" (click)="addGroupe()"></button>
                                        <button pButton pRipple label="Supprimer" icon="pi pi-trash"
                                                class="p-button-danger p-mb-2" (click)="deleteSelectedPolice()"
                                                [disabled]="!selectedGarants || !selectedGarants.length"></button>
                                    </ng-template>
                                    &lt;!&ndash;
                                    <ng-template pTemplate="right">
                                        <p-fileUpload mode="basic" accept="image/*" [maxFileSize]="1000000" label="Import" chooseLabel="Import" class="p-mr-2 p-mb-2 p-d-inline-block" ></p-fileUpload>
                                        <button pButton pRipple label="Export" icon="pi pi-upload" class="p-button-help p-mb-2" (click)="dt.exportCSV()"></button>
                                    </ng-template>
                                    &ndash;&gt;
                                </p-toolbar>
                                <p-table #dt [value]="groupeListFilter" [columns]="cols" [rows]="10" [paginator]="true"
                                         [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                                         [rowHover]="true" dataKey="id"
                                         styleClass="p-datatable-customers"
                                         currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                                         [showCurrentPageReport]="true">
                                    <ng-template pTemplate="caption">
                                        <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                            <h5 class="p-m-0"></h5>
                                            <span class="p-input-icon-left">
                                <i class="pi pi-search"></i>
                                <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                       placeholder="Search..." [style]="{width: '20%'}"/>
                                </span>
                                        </div>
                                    </ng-template>

                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width: 3rem">
                                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                            </th>
                                            <th pSortableColumn="nom">Libelle
                                                <p-sortIcon field="garant.nom"></p-sortIcon>
                                            </th>
                                            <th pSortableColumn="intermediaire" style="width: 12rem">Taux
                                                <p-sortIcon field="intermediaire.nom"></p-sortIcon>
                                            </th>
                                            <th pSortableColumn="numero">Duree
                                                <p-sortIcon field="numero"></p-sortIcon>
                                            </th>
                                            <th pSortableColumn="territorialite" style="width: 12rem">Territorialite
                                                <p-sortIcon field="territorialite.libelle"></p-sortIcon>
                                            </th>
                                            <th></th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-groupe>
                                        <tr>
                                            <td>
                                                <p-tableCheckbox [value]="groupe"></p-tableCheckbox>
                                            </td>
                                            <td><span class="p-column-title">{{groupe.libelle}}</span>

                                            </td>
                                            <td><span class="p-column-title">{{groupe.taux.taux}}</span>

                                            </td>
                                            <td><span class="p-column-title">{{groupe.duree}}</span>

                                            </td>
                                            <td><span class="p-column-title">{{groupe.territorialite.libelle}}</span></td>
                                            <td>
                                                <button pButton pRipple icon="pi pi-pencil" pTooltip="editer"
                                                        class="p-button-rounded p-button-success p-mr-2"
                                                        (click)="editPolice(police)"></button>
                                                <button pButton pRipple icon="pi pi-trash" pTooltip="supprimer"
                                                        class="p-button-rounded p-button-warning p-mr-2"
                                                        (click)="deletePolice(police)"></button>
                                                <button pButton pRipple icon="pi pi-angle-up" pTooltip="configurer le plafond"
                                                        class="p-button-rounded p-button-info p-mr-2"
                                                        (click)="parametrerPlafond(groupe)"></button>
                                                <button pButton pRipple icon="pi pi-eye" pTooltip="voir adherent"
                                                        class="p-button-rounded p-button-info p-mr-2"
                                                        (click)="voirAdherent()"></button>
                                            </td>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="summary">
                                        <div class="p-d-flex p-ai-center p-jc-between">
                                            {{groupeList ? groupeList.length : 0 }} groupes au total.
                                        </div>
                                    </ng-template>
                                </p-table>
                            </div>
                        </div>
                    </ng-template>
                </p-dialog>
        -->


        <p-dialog [(visible)]="displayDialogFormAddAdherent" header="Ajouter un adherent" [modal]="true"
                  styleClass="p-fluid" [style]="{'width':'900px'}" (onHide)="adherentForm.reset()">
            <ng-template pTemplate="content">
                <form (ngSubmit)="onCreateAddherent()" [formGroup]="adherentForm">
                    <div class="card">
                        <h5></h5>
                        <div class="p-fluid p-formgrid p-grid p-col">
                            <div class="p-field p-col">
                                <label for="firstname2">Nom</label>
                                <input id="nom" type="text" required formControlName="nom" pInputText>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Prenom</label>
                                <input id="lastname2" type="text" formControlName="prenom" pInputText>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Telephone</label>
                                <input id="lastname2" type="text" formControlName="numeroTelephone" pInputText>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="firstname2">Adresse Email</label>
                                <input id="firstname2" type="text" formControlName="adresseEmail" pInputText>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Adresse</label>
                                <input id="lastname2" type="text" formControlName="adresse" pInputText>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Reference bancaire</label>
                                <input id="lastname2" type="text" formControlName="referenceBancaire" pInputText>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Date de naissance</label>
                                <p-calendar [showIcon]="true" formControlName="dateNaissance" dateFormat="dd/mm/yy"
                                            inputId="calendar" appendTo="body"></p-calendar>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Lieu de naissance</label>
                                <input id="lastname2" type="text" formControlName="lieuNaissance" pInputText>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Date incorporation</label>
                                <p-calendar [showIcon]="true" formControlName="dateIncorporation" dateFormat="dd/mm/yy"
                                            inputId="calendar" appendTo="body"></p-calendar>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Date entrée</label>
                                <p-calendar [showIcon]="true" formControlName="dateEntree" dateFormat="dd/mm/yy"
                                            inputId="calendar" appendTo="body"></p-calendar>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Genre</label>
                                <p-dropdown inputId="genre" dataKey="id" [filter]="true" showClear="true"
                                            [options]="genreList" formControlName="genre" placeholder="Select"
                                            optionLabel="libelle"></p-dropdown>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Profession</label>
                                <p-dropdown inputId="profession" dataKey="id" [filter]="true" showClear="true"
                                            [options]="professionList" formControlName="profession" placeholder="Select"
                                            optionLabel="libelle"></p-dropdown>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col-4">
                                <label for="lastname2">Qualite assuré</label>
                                <p-dropdown inputId="qualiteAssure" dataKey="id" [filter]="true" showClear="true"
                                            [options]="qualiteAssureList" formControlName="qualiteAssure"
                                            placeholder="Select" optionLabel="libelle"></p-dropdown>
                            </div>
                        </div>

                    </div>
                </form>

                <div class="card">
                    <h5>Famille adherent</h5>
                    <p-toolbar styleClass="p-mb-4">
                        <ng-template pTemplate="left">
                            <button pButton type="button" icon="pi pi-plus" class="p-button-text" [label]="'Ajouter'"
                                    pAddRow [table]="dtFamilleAdherent" [newRow]="newRowFamilleAdherent()"></button>
                        </ng-template>
                    </p-toolbar>
                    <p-table #dtFamilleAdherent [value]="adherentFamilleList" dataKey="" editMode="row">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>Nom</th>
                                <th>Prenom</th>
                                <th>Telephone</th>
                                <th>Date de Naissance</th>
                                <th style="width:8em"></th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                            <tr [pEditableRow]="rowData">
                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="rowData.nom" required>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{rowData.nom}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>

                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="rowData.prenom" required>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{rowData.prenom}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>

                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="rowData.telephone" required>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{rowData.telephone}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>

                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <p-calendar [(ngModel)]="rowData.dateIncorporation" [showIcon]="true"
                                                        dateFormat="dd/mm/yy" inputId="calendar"
                                                        appendTo="body"></p-calendar>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{rowData.dateIncorporation}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>

                                <td style="text-align:center">
                                    <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil"
                                            class="ui-button-info"
                                            (click)="onRowEditInitAdherentFamille(rowData, ri)"></button>
                                    <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check"
                                            class="ui-button-success" style="margin-right: .5em"
                                            (click)="onRowEditSaveAdherentFamille(rowData, ri)"></button>
                                    <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times"
                                            class="ui-button-danger"
                                            (click)="onRowEditCancelAdherentFamille(rowData, ri)"></button>
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>


                <div class="p-grid p-justify-between">
                    <div>
                        <button pButton pRipple label="Quitter" icon="pi pi-times" class="p-button-text"
                                (click)="annulerSaisie()"></button>
                    </div>
                    <div>
                        <button [disabled]="adherentForm?.invalid" pButton pRipple label="Enregistrer"
                                icon="pi pi-check" class="p-button-text" (click)="onCreateAddherent()"></button>
                    </div>
                </div>
            </ng-template>
        </p-dialog>

        <p-dialog [(visible)]="displayDialogFormAdherent" header="Adherent et famille" [modal]="true"
                  styleClass="p-fluid" [style]="{'width':'950px'}">
            <ng-template pTemplate="content">
                <div class="">
                    <div class="card">
                        <p-toolbar styleClass="p-mb-4">
                            <ng-template pTemplate="left">
                                <button pButton pRipple label="Ajouter" icon="pi pi-plus"
                                        class="p-button-success p-mr-2 p-mb-2" (click)="addAdherent()"></button>
                                <button pButton pRipple label="Supprimer" icon="pi pi-trash"
                                        class="p-button-danger p-mb-2" (click)="deleteSelectedPolice()"
                                        [disabled]="!selectedGarants || !selectedGarants.length"></button>
                            </ng-template>
                            <!--
                            <ng-template pTemplate="right">
                                <p-fileUpload mode="basic" accept="image/*" [maxFileSize]="1000000" label="Import" chooseLabel="Import" class="p-mr-2 p-mb-2 p-d-inline-block" ></p-fileUpload>
                                <button pButton pRipple label="Export" icon="pi pi-upload" class="p-button-help p-mb-2" (click)="dt.exportCSV()"></button>
                            </ng-template>
                            -->
                        </p-toolbar>
                        <p-table #dt [value]="adherentList" [columns]="cols" [rows]="10" [paginator]="true"
                                 [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                                 [rowHover]="true" dataKey="id"
                                 styleClass="p-datatable-customers"
                                 currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                                 [showCurrentPageReport]="true">
                            <ng-template pTemplate="caption">
                                <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                    <h5 class="p-m-0"></h5>
                                    <span class="p-input-icon-left">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                               placeholder="Search..." [style]="{width: '20%'}"/>
                    </span>
                                </div>
                            </ng-template>

                            <ng-template pTemplate="header">
                                <tr>
                                    <th style="width: 3rem">
                                        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                    </th>
                                    <th pSortableColumn="nom" style="width: 7rem">Nom
                                        <p-sortIcon field="nom"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="prenom" style="width: 9rem">Prenom
                                        <p-sortIcon field="prenom"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numero" style="width: 12rem">Date Naissance
                                        <p-sortIcon field="dateNaissance"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="lieuNaissance" style="width: 12rem">Lieu de naissance
                                        <p-sortIcon field="lieuNaissance"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numeroTelephone" style="width: 10rem">Telephone
                                        <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="adresse" style="width: 10rem">Adresse
                                        <p-sortIcon field="adresse"></p-sortIcon>
                                    </th>
                                    <th></th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-aherent>
                                <tr>
                                    <td>
                                        <p-tableCheckbox [value]="adherent"></p-tableCheckbox>
                                    </td>
                                    <td><span class="p-column-title">{{adherent.nom}}</span>

                                    </td>
                                    <td><span class="p-column-title">{{adherent.prenom}}</span>
                                    </td>
                                    <td><span class="p-column-title">{{adherent.dateNaissance}}</span>
                                    </td>
                                    <td><span class="p-column-title">{{adherent.lieuNaissance}}</span></td>
                                    <td><span class="p-column-title">{{adherent.numeroTelephone}}</span></td>
                                    <td><span class="p-column-title">{{adherent.adresse}}</span></td>
                                    <td>
                                        <button pButton pRipple icon="pi pi-pencil" pTooltip="editer"
                                                class="p-button-rounded p-button-success p-mr-2"
                                                (click)="editPolice(police)"></button>
                                        <button pButton pRipple icon="pi pi-trash" pTooltip="Supprimer"
                                                class="p-button-rounded p-button-warning"
                                                (click)="deletePolice(police)"></button>
                                        <button pButton pRipple icon="pi pi-eye" pTooltip="voir groupe"
                                                class="p-button-rounded p-button-warning"
                                                (click)="voirGroupe(police)"></button>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="summary">
                                <div class="p-d-flex p-ai-center p-jc-between">
                                    {{adherentList ? adherentList.length : 0 }} assurés au total
                                </div>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </ng-template>
        </p-dialog>


        <p-dialog [(visible)]="displayDialogFormPolice" header="Police" [modal]="true" styleClass="p-fluid"
                  (onHide)="policeForm.reset()">
            <ng-template pTemplate="content">
                <form (ngSubmit)="onCreate()" [formGroup]="policeForm">
                    <div class="card">
                        <h5></h5>
                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="lastname2">Garant</label>
                                <p-dropdown dataKey="id" inputId="garant" [filter]="true" showClear="true"
                                            [options]="garantList" formControlName="garant" placeholder="Select"
                                            optionLabel="nom"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'garant'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Intermediaire</label>
                                <p-dropdown dataKey="id" inputId="intermediaire" [filter]="true" showClear="true"
                                            [options]="intermediaireList" formControlName="intermediaire"
                                            placeholder="Select" optionLabel="nom"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'intermediaire'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Taux de couverture</label>
                                <p-dropdown dataKey="id" inputId="taux" [filter]="true" showClear="true"
                                            [options]="tauxList" formControlName="taux" placeholder="Select"
                                            optionLabel="taux"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'taux'">
                                </app-entity-validation>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="firstname2">Territorialité</label>
                                <p-dropdown dataKey="id" inputId="territorialite" [filter]="true" showClear="true"
                                            [options]="territorialiteList" formControlName="territorialite"
                                            placeholder="Select" optionLabel="libelle"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'territorialite'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="dateEffet">Date effet</label>
                                <p-calendar [showIcon]="true" dateFormat="dd/mm/yy" inputId="calendar"
                                            formControlName="dateEffet" appendTo="body"></p-calendar>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'dateEffet'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="firstname2">Type durée</label>
                                <p-dropdown dataKey="id" inputId="typeDuree" [filter]="true" showClear="true"
                                            (ngModelChange)="changeTypeDuree()" [options]="typeDuree"
                                            formControlName="typeDuree" placeholder="Select"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'typeDuree'">
                                </app-entity-validation>
                            </div>

                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Durée</label>
                                <input id="lastname2" type="number" (input)="onRefreshDateEcheance($event.target.value)"
                                       formControlName="duree" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'duree'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col-4">
                                <label for="lastname2">Date echeance</label>
                                <p-calendar [showIcon]="true" dateFormat="dd/mm/yy" inputId="calendar"
                                            formControlName="dateEcheance" appendTo="body"></p-calendar>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'dateEcheance'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="firstname2">Nom du souscripteur</label>
                                <input id="nom" type="text" required formControlName="nom" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'nom'">
                                </app-entity-validation>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Contact</label>
                                <input id="lastname2" type="text" formControlName="contact" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'contact'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="firstname2">Adresse email</label>
                                <input id="firstname2" type="text" formControlName="adresseEmail" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'adresseEmail'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="adressePostale">Adresse postale</label>
                                <input id="adressePostale" type="text" formControlName="adressePostale" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'adressePostale'">
                                </app-entity-validation>
                            </div>

                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Secteur activite</label>
                                <p-dropdown dataKey="id" inputId="secteurActivite" [filter]="true" showClear="true"
                                            [options]="secteurActiviteList" formControlName="secteurActivite"
                                            placeholder="Select" optionLabel="libelle"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'secteurActivite'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Numero IFU</label>
                                <input id="lastname2" type="text" formControlName="numeroIfu" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'numeroIfu'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Personne ressource</label>
                                <input id="lastname2" type="text" formControlName="personneRessource" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'personneRessource'">
                                </app-entity-validation>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="lastname2">Periodicite Appel Fond</label>
                                <p-dropdown inputId="periodiciteAppelFond" dataKey="id" [filter]="true" showClear="true"
                                            [options]="dimensionPeriodeList" formControlName="periodiciteAppelFond"
                                            placeholder="Select" optionLabel="libelle"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'periodiciteAppelFond'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="refPolice">Reference police</label>
                                <input id="referencePolice" type="text" formControlName="referencePolice" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'referencePolice'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Rccm</label>
                                <input id="lastname2" type="text" formControlName="rccm" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'rccm'">
                                </app-entity-validation>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="lastname2">Pays</label>
                                <p-dropdown inputId="pays" [filter]="true" dataKey="id" showClear="true"
                                            [options]="paysList" formControlName="pays" placeholder="Select"
                                            optionLabel="libelle"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'pays'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Region</label>
                                <p-dropdown inputId="region" [filter]="true" showClear="true" dataKey="id"
                                            [options]="regionList" formControlName="region" placeholder="Select"
                                            optionLabel="libelle"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'region'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Departement</label>
                                <p-dropdown inputId="departement" [filter]="true" showClear="true" dataKey="id"
                                            [options]="departementList" formControlName="departement"
                                            placeholder="Select" optionLabel="libelle"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'departement'">
                                </app-entity-validation>
                            </div>
                        </div>


                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col-4">
                                <label for="lastname2">Commune</label>
                                <p-dropdown inputId="commune" [filter]="true" showClear="true" [options]="communeList"
                                            dataKey="id" formControlName="commune" placeholder="Select"
                                            optionLabel="libelle"></p-dropdown>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'commune'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="fraisAccessoire">Frais accessoire</label>
                                <input id="fraisAccessoire" type="text" formControlName="fraisAccessoire" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'fraisAccessoire'">
                                </app-entity-validation>
                            </div>

                            <div class="p-field p-col">
                                <label for="fraisBadge">Frais badge</label>
                                <input id="fraisBadge" type="text" formControlName="fraisBadge" pInputText>
                                <app-entity-validation [entityValidations]="entityValidations"
                                                       [formGroup]="policeForm" [entityField]="'fraisBadge'">
                                </app-entity-validation>
                            </div>
                        </div>
                    </div>
                    <div class="p-grid p-justify-between">
                        <div>
                            <button pButton pRipple label="Quitter" icon="pi pi-times"
                                    class="p-button-danger p-button-text"
                                    (click)="annulerSaisie()"></button>
                        </div>
                        <div>
                            <button [disabled]="policeForm?.invalid" pButton pRipple label="Enregistrer"
                                    icon="pi pi-check" class="p-button-success p-button-text" type="submit"></button>
                        </div>
                    </div>
                </form>
            </ng-template>
        </p-dialog>

        <p-dialog [(visible)]="dissplayavenant" [header]="entete" [modal]="true" styleClass="p-fluid"
                  [style]="{width: '1400px'}" (onHide)="delAvenenant()" [maximizable]="true">
            <div class="card">
                <div class="p-fluid p-grid" *ngIf="isAvenantIncorporation">
                    <!-- 
                        pour appeler l'avenant d'incorporation 
                        isRenouv : pour savoir si c'est un avenant d'incorporation qui l'appel ou pas
                        adherentPrincipauxTMP: liste des assurés principaux
                        etat: VIEW pour visualiser | UPDATE pour la mise à jour | CREATE pour la création
                        police: pour la police
                        avenantId: id de l'avenant à charger

                    -->
                    <app-avenant-incorporation [isRenouv]="false" [adherentPrincipauxTMP]="adherentListGroupe" [etat]="etat" [avenantId]="historiqueAvenant.id"
                                               (adherentFamilleEvent)="addAdherentFamille($event)" [police]="policeItem" [groupesInput]="historiqueAvenant.id"></app-avenant-incorporation>
                </div>
                <div class="p-fluid p-grid" *ngIf="isAvenantRetrait">
                    <!-- 
                        pour appeler l'avenant d'incorporation
                        -isRenouv : pour savoir si c'est un avenant d'incorporation qui l'appel ou pas
                        -adherentPrincipauxTMP: liste des assurés principaux
                        -etat: VIEW pour visualiser | UPDATE pour la mise à jour | CREATE pour la création
                        -police: pour la police
                        -avenantId: id de l'avenant à charger
                        -avenantDate : date de l'avenant
                        -adherentFamilleEvent: liste des adhérents que le composant doit retourner
                    -->
                    <app-avenant-retrait [police]="policeItem"  [isRenouv]="false" [avenantDate]="" [etat]="etat" [avenantId]="historiqueAvenant.id"
                                         (adherentFamilleEvent)="deleteAdherant($event)"></app-avenant-retrait>
                </div>
                <div class="p-fluid p-grid" *ngIf="isAvenantModification">
                    <app-avenant-modification [police]="policeItem" [avenant]="historiqueAvenant" (returnEvent)="getSortie($event)" [etat]="etat" [avenantId]="historiqueAvenant.id"
                                              (eventEmitterM)="getAvenantModification($event)"></app-avenant-modification>
                </div>
                <div class="p-fluid p-grid" *ngIf="isAvenantRenouvellement && policeItem">
                    <app-avenant-renouvellement [police]="policeItem" [etat]="etat" [avenantId]="historiqueAvenant.id" [groupesRev]="historiqueGroupeRev"
                    [avenantArrivedId]="historiqueRev?.id" (eventEmitterM)="getAvenantRenouvellement($event)">
                </app-avenant-renouvellement>
                </div>
                <div class="p-fluid p-col-12" *ngIf="isAvenantResiliation">
                    <app-avenant-resiliation [police]="policeItem"  [etat]="etat" [avenantId]="historiqueAvenant.id"
                                                (eventEmitterResiliation)="getAvenantResiliation($event)"></app-avenant-resiliation>
                </div>
                <div class="p-fluid p-col-12" *ngIf="isAvenantSuspension">
                    <app-avenant-suspension [police]="policeItem" [etat]="etat" [avenantId]="historiqueAvenant.id"
                                                (eventEmitterSuspension)="getAvenantSuspension($event)"></app-avenant-suspension>
                </div>
                <div class="p-fluid p-col-12" *ngIf="isAvenantFacturation">
                    <app-avenant-facturation></app-avenant-facturation>
                </div>
            </div>


        </p-dialog>


        <!--Affichage de la liste des avenants de la police -->
        <p-dialog [maximizable]="true" [(visible)]="infosPolice" header="Police details" [modal]="true"
                  styleClass="p-fluid" [style]="{width: '1500px'}">
            <ng-template pTemplate="content">
                <div class="card">
                    <h5></h5>
                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-col">
                            <label for="lastname2">Garant</label>
                            <div>
                                <span>{{police?.garant?.nom}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Intermediaire</label>
                            <div>
                                <span>{{police?.intermediaire?.nom}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Taux de couverture</label>
                            <div>
                                <span>{{police.taux.taux}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="firstname2">Territorialité</label>
                            <div>
                                <span *ngFor="let t of police.territorialite">{{t.libelle}} </span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="dateEffet">Date effet</label>
                            <div>
                                <span>{{police.dateEffet}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col-4">
                            <label for="lastname2">Date echeance</label>
                            <div>
                                <span>{{police.dateEcheance}}</span>
                            </div>
                        </div>

                    </div>

                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-col">
                            <label for="firstname2">Nom du souscripteur</label>
                            <div>
                                <span>{{police.nom}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Contact</label>
                            <div>
                                <span>{{police.contact}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="firstname2">Adresse email</label>
                            <div>
                                <span>{{police.adresseEmail}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="adressePostale">Adresse postale</label>
                            <div>
                                <span>{{police.adressePostale}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Secteur activite</label>
                            <div>
                                <span>{{police.secteurActivite.libelle}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Numero IFU</label>
                            <div>
                                <span>{{police.numeroIfu}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="lastname2">Personne ressource</label>
                            <div>
                                <span>{{police.personneRessource}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Contact personne ressource</label>
                            <div>
                                <span>{{police.contactPersonneRessource}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="refPolice">Reference police</label>
                            <div>
                                <span>{{police.referencePolice}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="lastname2">Rccm</label>
                            <div>
                                <span>{{police.rccm}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Numero police</label>
                            <div>
                                <span>{{police.numero}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Secteur</label>
                            <div>
                                <span>{{police.secteur.libelle}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col-4">
                            <label for="fraisAccessoire">Frais accessoires</label>
                            <div>
                                <span>{{police?.fraisAccessoire | formatTableValue: 'number':true}}</span>
                            </div>
                        </div>
                        <div class="p-field p-col-4">
                            <label for="fraisBadge">Frais badges</label>
                            <div>
                                <span>{{police?.fraisBadge | formatTableValue: 'number':true}}</span>
                            </div>
                        </div>
                    </div>

                </div>
                <!--Liste des avenants de la police-->
                <h4> Avenant(s) de la police N°:
                    <mark>{{police?.numero}}</mark>
                    du Souscripteur:
                    <mark>{{police.nom}}</mark>
                </h4>
                <div class="card">
                    <div class="p-grid">
                        <div class="p-col-4">
                            <label for="fraisBadge">Exercice</label>
                            <p-dropdown [options]="exerciceList" [(ngModel)]="curentExercice" optionLabel="nomExo" placeholder="Selectionner un exercice" [filter]="true"
                                        [style]="{'width':'100%'}" [dataKey]="id" filterBy="nomExo" [showClear]="true" (onChange)="onExerciceChange()">
                            </p-dropdown>
                        </div>
                        <div class="p-col-4">
                            <button pButton pRipple icon="pi pi-dollar" style="margin-top: 17px !important;" pTooltip="Prime Totale de la Police"
                                    class="p-button-raised p-button-help p-mr-2" label="Prime Totale de la Police" (click)="getPolicePrimeTotale(police)">
                            </button>
                        </div>
                        <div class="p-col-4">
                            <button pButton pRipple icon="pi pi-list" style="margin-top: 17px !important;" pTooltip="Liste actualisée de la police"
                                    class="p-button-raised p-button-secondary p-mr-2" label="Liste actualisée" (click)="loadActualList(police)">
                            </button>
                        </div>
                    </div>
                    <p-table #dt [value]="historiqueAvenants1" [columns]="cols" [rows]="10" [paginator]="true"
                             [globalFilterFields]="['typeHistoriqueAvenant']"
                             [rowHover]="true" dataKey="id"
                             styleClass="p-datatable-customers"
                             currentPageReportTemplate="affichage {first} à {last} de {totalRecords} enregistrement"
                             [showCurrentPageReport]="true">
                        <ng-template pTemplate="caption">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                <h5 class="p-m-0"></h5>
                                <span class="p-input-icon-left">
                                    <i class="pi pi-search"></i>
                                    <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                           placeholder="Rechercher le type d'avenant..."/>
                                </span>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr>
                                <th pSortableColumn="numero" style="width: 4rem">N°
                                    <p-sortIcon field="numero"></p-sortIcon>
                                </th>
                                <th pSortableColumn="typeAvenant">Type d'avenant
                                    <p-sortIcon field="typeAvenant"></p-sortIcon>
                                </th>
                                <th pSortableColumn="duree">Durée Police
                                    <p-sortIcon field="duree"></p-sortIcon>
                                </th>
                                <th pSortableColumn="dateEffet">Date d'effet
                                    <p-sortIcon field="dateEffet"></p-sortIcon>
                                </th>
                                <th pSortableColumn="dateEcheance">Date d'échéance
                                    <p-sortIcon field="dateEcheance"></p-sortIcon>
                                </th>
                                <th>Status</th>
                                <th style="width: 30em;"></th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowdata>
                            <tr>
                                <td><span class="p-column-title">{{rowdata?.numero}}</span>
                                </td>
                                <td>
                                    <span *ngIf="rowdata.typeHistoriqueAvenant.toString() === 'AFAIRE_NOUVELLE'" class="p-column-title">AFFAIRE NOUVELLE</span>
                                    <span *ngIf="rowdata.typeHistoriqueAvenant.toString() !== 'AFAIRE_NOUVELLE'" class="p-column-title">{{rowdata.typeHistoriqueAvenant}}</span>
                                </td>
                                <td><span class="p-column-title">{{rowdata.police.duree}}</span>
                                </td>
                                <td><span
                                        class="p-column-title">{{rowdata.dateEffet | formatTableValue : 'date'}}</span>
                                </td>
                                <td>
                                    <span class="p-column-title">{{rowdata?.exercice?.fin | formatTableValue : 'date'}}</span>
                                </td>
                                <td>
                                    <span *ngIf="rowdata?.valide" style="color: green; font-weight: bold">VALIDÉ</span>
                                    <span *ngIf="!rowdata?.valide" style="color: red; font-weight: bold">EN ATTENTE ...</span>

                                </td>
                                <td style="width: 30em;">
                                    <div class="p-grid p-mt-1">
                                        <div class="p-col- p-mr-2">
                                            <p-inputSwitch (onChange)="changeStatus(rowdata, rowdata.valide); onRowSelectPolice(rowdata.police)" [(ngModel)]="rowdata.valide"
                                                           [disabled]="!disableAvenant(rowdata)"></p-inputSwitch>
                                        </div>
                                        <div class="p-col-">
                                            <button pButton pRipple icon="pi pi-eye" pTooltip="voir details"
                                                    class="p-button-rounded p-button-info p-mr-2"
                                                    (click)=" avenantItem = rowdata; onRowSelectAvenant(rowdata); getGroupeByPolice(rowdata)">
                                            </button>
                                            <button pButton pRipple icon="pi pi-pencil" pTooltip="Modifier"
                                                    class="p-button-rounded p-button-warning p-mr-2 p-mr-2"
                                                    (click)="onUpdateAvenant(rowdata)" [disabled]="rowdata.valide">
                                            </button>
                                        </div>
                                        <div class="p-col-">
                                            <button pButton pRipple icon="pi pi-search" pTooltip="voir Prime"
                                                    class="p-button-rounded p-button-warning p-mr-2"
                                                    (click)="voirPrime(rowdata)" [disabled]="!rowdata.valide">
                                            </button>
                                        </div>
                                        <div class="p-col-">
                                            <button pButton pRipple icon="pi pi-dollar" pTooltip="Calculer prime" (click)="calculerPrime(rowdata)"
                                                    class="p-button-rounded p-button-help p-mr-2" [disabled]="rowdata.valide">
                                            </button>
                                        </div>
                                        <div class="p-col-">
                                            <button pButton pRipple icon="pi pi-times" pTooltip="Supprimer" (click)="supprimerAvenant(rowdata)"
                                                    class="p-button-rounded p-button-danger p-mr-2" [disabled]="rowdata.valide">
                                            </button>
                                        </div>
                                        <div class="p-col-">
                                            <p-splitButton label="Quittance" icon="pi pi-print" [model]="typeAvenants"
                                                           (onDropdownClick)="onTypeHistoriqueAvenantChoose(rowdata.typeHistoriqueAvenant, rowdata)">
                                            </p-splitButton>
                                        </div>
                                    </div>


                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            <div class="p-d-flex p-ai-center p-jc-between">
                                {{historiqueAvenants1 ? historiqueAvenants1?.length : 0 }} Avenant(s).
                            </div>
                        </ng-template>
                    </p-table>
                </div>
            </ng-template>
        </p-dialog>

        <!--Affichage des details de chaque avenant -->

        <!--Affichage des details des avenants d'incorporation -->
        <p-dialog [maximizable]="true" [(visible)]="displayDialogFormAdherentIncorp"
                  header="Adhérent(s) et membre(s) de familles ajouté(s)" [modal]="true" styleClass="p-fluid"
                  [style]="{'width':'1400px'}">
            <ng-template pTemplate="content">
                <div class="">
                    <div class="card">
                        <p-table #dt [value]="historiqueAvenantAdherents" [columns]="cols" [rows]="10"
                                 [paginator]="true"
                                 [globalFilterFields]="['adherent.nom','adherent.prenom','adherent.telephone','adherent.lieuNaissance','adherent.qualiteAssure.libelle']"
                                 [rowHover]="true" dataKey="id"
                                 styleClass="p-datatable-customers"
                                 currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                                 [showCurrentPageReport]="true">
                            <ng-template pTemplate="caption">
                                <div class="p-d-flex p-flex-column table-header">
                                    <div class="p-grid">
                                        <div class="p-col-9">
                                            <span class="p-input-icon-left">
                                                <i class="pi pi-search"></i>
                                                <input pInputText type="text"
                                                       (input)="dt.filterGlobal($event.target.value, 'contains')"
                                                       placeholder="Rechercher..." [style]="{width: '20%'}"/>
                                            </span>
                                        </div>
                                        <div class="p-col-2">
                                            <span class="p-input-icon-right">
                                                <button pButton pRipple icon="pi pi-print" label="Imprimer"
                                                        pTooltip="Imprimer la liste"
                                                        class="p-button-info"
                                                        (click)="onAdherentPrintIncorporation(historiqueAvenant)"></button>
                                            </span>
                                        </div>
                                    </div>

                                </div>
                            </ng-template>

                            <ng-template pTemplate="header">
                                <tr>
                                    <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                        <p-sortIcon field="numero"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                                        <p-sortIcon field="numeroGarant"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="nom" style="width: 7rem">Nom
                                        <p-sortIcon field="nom"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="prenom" style="width: 9rem">Prénom(s)
                                        <p-sortIcon field="prenom"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numero" style="width: 12rem">Date Naissance
                                        <p-sortIcon field="dateNaissance"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="lieuNaissance" style="width: 12rem">Lieu de naissance
                                        <p-sortIcon field="lieuNaissance"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numeroTelephone" style="width: 10rem">Téléphone
                                        <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="adresse" style="width: 10rem">Date Inc.
                                        <p-sortIcon field="adresse"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="qla" style="width: 10rem">Qualité Assuré
                                        <p-sortIcon field="qla"></p-sortIcon>
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-adherentHis>
                                <tr [ngClass]="{'colorZone': !adherentHis.adherent.adherentPrincipal}">
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.numero}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.matriculeGarant}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.nom}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.prenom}}</span></td>
                                    <td><span
                                            class="p-column-title">{{adherentHis?.adherent?.dateNaissance | formatTableValue : 'date'}}</span>
                                    </td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.lieuNaissance}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.numeroTelephone}}</span>
                                    </td>
                                    <td><span class="p-column-title">{{adherentHis?.dateIncorporation}}</span>
                                    </td>
                                    <td><span
                                            class="p-column-title">{{adherentHis?.adherent?.qualiteAssure?.libelle}}</span>
                                    </td>
                                    <!-- <td>
                                        <button pButton pRipple icon="pi pi-pencil" pTooltip="editer" class="p-button-rounded p-button-success p-mr-2" (click)="modifierAdherent(adherent)"></button>
                                        <button pButton pRipple icon="pi pi-trash" pTooltip="Supprimer" class="p-button-rounded p-button-warning p-mr-2" (click)="supprimerAdherent(adherent)"></button>
                                        <button pButton pRipple icon="pi pi-eye" pTooltip="voir details" class="p-button-rounded p-button-warning" (click)="voirDetailAdherent(adherent)"></button>
                                    </td> -->
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="summary">
                                <div class="p-d-flex p-ai-center p-jc-between">
                                    {{historiqueAvenantAdherents1 ? historiqueAvenantAdherents1.length : 0 }} assuré(s).
                                </div>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </ng-template>
        </p-dialog>

        <!--Affichage des details des avenants de retrait -->
        <p-dialog [maximizable]="true" [(visible)]="displayDialogFormAdherentRetrait"
                  header="Adhérent(s) et membre(s) de familles Rétiré(s)" [modal]="true" styleClass="p-fluid"
                  [style]="{'width':'1400px'}">
            <ng-template pTemplate="content">
                <div class="">
                    <div class="card">
                        <p-table #dt [value]="historiqueAvenantAdherent1s" [columns]="cols" [rows]="10"
                                 [paginator]="true"
                                 [globalFilterFields]="['adherent.nom','adherent.prenom','adherent.telephone','adherent.lieuNaissance','adherent.qualiteAssure.libelle']"
                                 [rowHover]="true" dataKey="id"
                                 styleClass="p-datatable-customers"
                                 currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                                 [showCurrentPageReport]="true">
                            <ng-template pTemplate="caption">
                                <div class="p-d-flex p-flex-column table-header">
                                    <div class="p-grid">
                                        <div class="p-col-9">
                                            <span class="p-input-icon-left">
                                                <i class="pi pi-search"></i>
                                                <input pInputText type="text"
                                                       (input)="dt.filterGlobal($event.target.value, 'contains')"
                                                       placeholder="Rechercher..." [style]="{width: '20%'}"/>
                                            </span>
                                        </div>
                                        <div class="p-col-2">
                                            <span class="p-input-icon-right">
                                                <button pButton pRipple icon="pi pi-print" label="Imprimer"
                                                        pTooltip="Imprimer la liste"
                                                        class="p-button-info"
                                                        (click)="onAdherentPrintRetrait(historiqueAvenant)"></button>
                                            </span>
                                        </div>
                                    </div>

                                </div>
                            </ng-template>

                            <ng-template pTemplate="header">
                                <tr>

                                    <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                        <p-sortIcon field="numero"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                                        <p-sortIcon field="numeroGarant"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="nom" style="width: 7rem">Nom
                                        <p-sortIcon field="nom"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="prenom" style="width: 9rem">Prenom
                                        <p-sortIcon field="prenom"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numero" style="width: 12rem">Date de Naissance
                                        <p-sortIcon field="dateNaissance"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="lieuNaissance" style="width: 12rem">Lieu de naissance
                                        <p-sortIcon field="lieuNaissance"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="numeroTelephone" style="width: 10rem">Telephone
                                        <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="adresse" style="width: 10rem">Date de Retrait
                                        <p-sortIcon field="adresse"></p-sortIcon>
                                    </th>
                                    <th pSortableColumn="qla" style="width: 10rem">Qualité Assuré
                                        <p-sortIcon field="qla"></p-sortIcon>
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-adherentHis>
                                <tr [ngClass]="{'colorZone': !adherentHis.adherent.adherentPrincipal}">
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.numero}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.matriculeGarant}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.nom}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.prenom}}</span></td>
                                    <td><span
                                            class="p-column-title">{{adherentHis?.adherent?.dateNaissance | formatTableValue : 'date'}}</span>
                                    </td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.lieuNaissance}}</span></td>
                                    <td><span class="p-column-title">{{adherentHis?.adherent?.numeroTelephone}}</span>
                                    </td>
                                    <td><span class="p-column-title">{{adherentHis?.dateRetrait}}</span>
                                    </td>
                                    <td><span
                                            class="p-column-title">{{adherentHis?.adherent?.qualiteAssure?.libelle}}</span>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="summary">
                                <div class="p-d-flex p-ai-center p-jc-between">
                                    {{historiqueAvenantAdherent1s ? historiqueAvenantAdherent1s.length : 0 }} assuré(s).
                                </div>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </ng-template>
        </p-dialog>


        <p-confirmDialog [style]="{width: '450px'}" acceptLabel="Oui" rejectLabel="Non"></p-confirmDialog>
    </div>

   <!--  affichage de la liste actualisée -->
    <p-dialog [(visible)]="displayALA" header="LISTE ACTUALISEE" [modal]="true" styleClass="p-fluid" (onHide)="fermerListe()"
              [style]="{width: '1400px'}">

              <div class="p-grid">
                <div class="p-col-4">
                    <label for="fraisBadge">Exercice<span style="color: red !important; size: 2em">*</span></label>
                    <p-dropdown [options]="exerciceList" [(ngModel)]="curentExercice" optionLabel="nomExo" placeholder="Selectionner un exercice" [filter]="true"
                                [style]="{'width':'100%'}" filterBy="nomExo" [showClear]="true" (onChange)="findAdherentListByExerciceId(curentExercice)">
                    </p-dropdown>
                </div>
            </div>
        <div class="card">
            <p-table #dtAL [value]="adherentsListeActuelleByExercice" [columns]="colsAL" [rows]="10" [paginator]="true"
                     [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                     [rowHover]="true" dataKey="id" [exportFilename]="'liste actualisée'" csvSeparator=";"
                     styleClass="p-datatable-customers"
                     currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                     [showCurrentPageReport]="true">
                <ng-template pTemplate="caption">
                    <div class="table-header">
                        <h5 class="p-m-0"></h5>
                        <div class="p-grid">
                            <div class="p-col-8">
                                <span class="p-input-icon-left">
                                    <i class="pi pi-search"></i>
                                    <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                       placeholder="Search..." [style]="{width: '20%'}"/>
                                </span>

                            </div>
                            <div class="p-col-2">
                                <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                    <button pButton pRipple label="Exporter" [disabled]="adherentsListeActuelleByExercice.length > 1" icon="pi pi-upload" class="p-button-help"
                                            (click)="dtAL.exportCSV()"></button>
                                </div>
                            </div>
                            <!--<div class="p-col-2">
                                <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                    <button pButton pRipple label="Imprimer" (click)="printListeActualisee(historiqueAvenant)" icon="pi pi-print" class="p-button-info">

                                    </button>
                                </div>
                            </div>-->
                        </div>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr>
                        <th pSortableColumn="signeAdherent" style="font-size: 12px !important; font-weight: bold; width: 5rem">Signe
                            <p-sortIcon field="signeAdherent"></p-sortIcon>
                        </th>
                        <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold; width: 5rem">Matricule
                            <p-sortIcon field="numero"></p-sortIcon>
                        </th>
                        <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold; width: 5rem">Matricule Garant
                            <p-sortIcon field="numeroGarant"></p-sortIcon>
                        </th>
                        <th pSortableColumn="nom" style="width: 12rem">Nom
                            <p-sortIcon field="nom"></p-sortIcon>
                        </th>
                        <th pSortableColumn="prenom" style="width: 12rem">Prénom
                            <p-sortIcon field="prenom"></p-sortIcon>
                        </th>
                        <th pSortableColumn="adresseEmail" style="width: 5rem">Groupe
                            <p-sortIcon field="adresseEmail"></p-sortIcon>
                        </th>
                        <th pSortableColumn="adresseEmail" style="width: 12rem">Email
                            <p-sortIcon field="adresseEmail"></p-sortIcon>
                        </th>
                        <th pSortableColumn="numeroTelephone" style="width: 8rem">Téléphone
                            <p-sortIcon field="numeroTelephone"></p-sortIcon>
                        </th>
                        <th pSortableColumn="genre" style="width: 3rem">Genre
                            <p-sortIcon field="genre.libelle"></p-sortIcon>
                        </th>
                        <th pSortableColumn="dateSortie" style="width: 6rem">Date de l'action
                            <p-sortIcon field="dateSortie"></p-sortIcon>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-adherent>
                    <tr [ngClass]="{'colorZone': !adherent?.adherentPrincipal}">
                        <td *ngIf="adherent?.signeAdherent ==='*'"><span style="color: blue; font-size: 1.3em; font-weight: bold;" class="p-column-title">{{adherent?.signeAdherent}}</span></td>
                        <td *ngIf="adherent?.signeAdherent ==='-'"><span style="color: red; font-size: 1.3em; font-weight: bold;" class="p-column-title">{{adherent?.signeAdherent}}</span></td>
                        <td *ngIf="adherent?.signeAdherent ==='+'"><span style="color: yellowgreen; font-size: 1.3em; font-weight: bold;" class="p-column-title">{{adherent?.signeAdherent}}</span></td>
                        <td *ngIf="adherent?.signeAdherent === null"><span style="color: blue; font-size: 1.3em; font-weight: bold;" class="p-column-title">{{adherent?.signeAdherent}}</span></td>
                        <td><span class="p-column-title">{{adherent?.numero}}</span></td>
                        <td><span class="p-column-title">{{adherent?.matriculeGarant}}</span></td>
                        <td><span class="p-column-title">{{adherent?.nom}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.prenom}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.groupe?.libelle}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.adresseEmail}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.numeroTelephone}}</span>

                        </td>
                        <td *ngIf="adherent?.genre?.libelle === 'Feminin'"><span class="p-column-title">F</span></td>
                        <td *ngIf="adherent?.genre?.libelle === 'Masculin'"><span class="p-column-title">M</span></td>
                        <td *ngIf="adherent?.signeAdherent ==='-'"><span style="color: red; font-size: 1em;" class="p-column-title">{{adherent?.dateSortie | formatTableValue : 'date'}}</span></td>
                        <td *ngIf="adherent?.signeAdherent ==='+'"><span style="color: yellowgreen; font-size: 1em;" class="p-column-title">{{adherent?.dateIncorporation | formatTableValue : 'date'}}</span></td>
                        <td *ngIf="adherent?.signeAdherent ==='*'"><span style="color: blue; font-size: 1em;">{{adherent?.exercice?.debut | formatTableValue : 'date'}}</span></td>
                        <td *ngIf="adherent?.signeAdherent === null"><span style="color: blue; font-size: 1em;">{{adherent?.exercice?.debut | formatTableValue : 'date'}}</span></td>

                    </tr>
                </ng-template>
                <ng-template pTemplate="summary">
                    <div class="p-d-flex p-ai-center p-jc-between">
                        {{adherentsListeActuelleByExercice ? adherentsListeActuelleByExercice.length : 0 }} assuré(s) |       {{adherentsListeActuelleByExerciceRetirer ? adherentsListeActuelleByExerciceRetirer.length : 0 }} assuré(s) non pris en compte.
                    </div>
                </ng-template>
                <!-- <ng-template pTemplate="summary">
                    <div class="p-d-flex p-ai-center p-jc-between">
                        <button pButton pRipple label="Fermer" style="margin-top: 10px !important; text-align: center !important;" 
                        icon="pi pi-times" class="p-button p-button-danger" type="button"
                                (click)="annulerPrimeTotalePolice()">
                        </button>
                    </div>
                </ng-template> -->
            </p-table>
        </div>
        <div class="p-grid">
            <div p-col-sm-2>
                <button pButton pRipple label="Fermer" style="margin-top: 10px !important; text-align: center !important;" 
                        icon="pi pi-times" class="p-button p-button-danger" type="button"
                        (click)="fermerListe()">
                </button>
            </div>
        </div>
    </p-dialog>

    <!-- affichage de la prime totale de la police-->
    <p-dialog [(visible)]="displayPrimeTotalePolice" header="Prime totale de la police" [modal]="true" styleClass="p-fluid"
              [style]="{width: '1000px'}">

              <!-- <div class="p-grid">
                <div class="p-col-4">
                    <label for="fraisBadge">Exercice</label>
                    <p-dropdown [options]="exerciceList" [(ngModel)]="curentExercice" optionLabel="nomExo" placeholder="Selectionner un exercice" [filter]="true"
                                [style]="{'width':'100%'}" filterBy="nomExo" [showClear]="true" (onChange)="findAdherentListByExerciceId(curentExercice)">
                    </p-dropdown>
                </div>
            </div> -->
            <ng-template pTemplate="content">
                <div class="">
                    <div class="card">
                        
                        <div class="p-grid mt-3">
                            
                                <span *ngIf="historiqueAvenantPrime?.primeTotaleEncaissee" class="primeCaisse">Prime Totale encaissée =>  {{historiqueAvenantPrime?.primeTotaleEncaissee | formatTableValue: 'number':true}} FCFA </span>
                                <span *ngIf="historiqueAvenantPrime?.primeTotalRestituee" class="primeRendu">Prime Totale restituée =>  {{historiqueAvenantPrime?.primeTotalRestituee | formatTableValue: 'number':true}} FCFA </span>
                                <span *ngIf="historiqueAvenantPrime?.primeTotalCalcul" class="prime"> Prime Réelle de la police =>  {{historiqueAvenantPrime?.primeTotalCalcul | formatTableValue: 'number':true}} FCFA </span>
        
                            <!-- <div class="p-col-2">
                                <button type="button" pButton pRipple label="Valider Prime" icon="pi pi-save" class="p-button p-button-success"
                                    (click)="validerPrime( historiqueAvenantPrimes[0].historiqueAvenant)" [disabled]="historiqueAvenantPrimes[0].status">
                                </button>
                            </div> -->
                        </div>
                    </div>
                </div>
              </ng-template>
              <ng-template pTemplate="footer">
                <div class="p-d-flex p-ai-center p-jc-between">
                    <button pButton pRipple label="Fermer" style="margin-top: 10px !important; text-align: center !important;" 
                    icon="pi pi-times" class="p-button p-button-danger" type="button"
                            (click)="annulerPrimeTotalePolice()">
                    </button>
                </div>
            </ng-template>
              <div class="p-col-2">
                
            </div>
    </p-dialog>

    <!--Affichage desla fenetre de choix de groupe pour l'impression -->
    <p-dialog [(visible)]="displayImpGroupe" header="impression de la liste des assurés par groupe" [modal]="true" styleClass="p-fluid"
              [style]="{width: '1000px'}">

            <div class="p-grid mt-3">
                <div class="p-col-12 mt-3">
                    <div class="p-grid">
                        <!-- <div class="p-col-4">
                            <label for="fraisBadge">Exercice<span style="color: red !important; size: 2em">*</span></label>
                            <p-dropdown [options]="exerciceList" [(ngModel)]="curentExercice" optionLabel="nomExo" placeholder="Selectionner un exercice" [filter]="true"
                                        [style]="{'width':'100%'}" filterBy="nomExo" [showClear]="true" (onChange)="findAdherentListByExerciceId(curentExercice)">
                            </p-dropdown>
                        </div> -->
                        <div class="p-col-4">
                            <!-- <label for="fraisBadge">Groupe<span style="color: red !important; size: 2em">*</span></label>
                            <p-dropdown [options]="listGroupe" optionLabel="libelle" placeholder="Selectionner un groupe" [filter]="true"
                                        [style]="{'width':'100%'}" filterBy="libelle" [showClear]="true" (onChange)="onAdherentPrintAffaireNouvelle(historiqueAvenant)">
                            </p-dropdown> -->
                            
                            <label class="p-fieldset-content">Choisir le Groupe</label>
                        <p-dropdown [options]="groupeListes" optionLabel="libelle" [(ngModel)]="groupeSelect"
                                    [filter]="true" filterBy="libelle" [showClear]="true"
                                    placeholder="Choisir un groupe" (onChange)="onAdherentPrintAffaireNouvelle(historiqueAvenant, groupeSelect)"
                                    [style]="{'width': '100%'}">
                        </p-dropdown>


                        </div>
                    </div>
                </div>
                
            </div>
              <div class="p-col-12 mb-3">
                <div class="p-col-4"> 
                    
                        <button pButton pRipple label="Fermer" style="margin-top: 10px !important; text-align: center !important;" 
                        icon="pi pi-times" class="p-button p-button-danger" type="button"
                                (click)="annulerPrimeTotalePolice()">
                        </button>
                   
                </div>
                
            </div>
              <div class="p-col-2">
                
            </div>
    </p-dialog>



    <!--Affichage des details des avenants affaire nouvelle -->
    <p-dialog [maximizable]="true" [(visible)]="displayDialogFormAdherentAffaireNouvelle"
              header="Adhérent(s) et membre(s) de la police Affaire Nouvelle" [modal]="true" styleClass="p-fluid"
              [style]="{'width':'1400px'}">
        <ng-template pTemplate="content">
            <div class="">
                <div class="card">
                    <p-table #dt [value]="historiqueAvenantAdherent1s" [columns]="cols" [rows]="10"
                             [paginator]="true"
                             [globalFilterFields]="['adherent.nom','adherent.prenom','adherent.telephone','adherent.lieuNaissance','adherent.qualiteAssure.libelle']"
                             [rowHover]="true" dataKey="id"
                             styleClass="p-datatable-customers"
                             currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                             [showCurrentPageReport]="true" (onRowSelect)="onRowSelect($event)">
                        <ng-template pTemplate="caption">
                            <div class="p-d-flex p-flex-column table-header">
                                <div class="p-grid">

                                    <div class="p-col-8">
                                    
                                        <div class="p-mr-2 p-mb-2">
                                            <p-fileUpload #form mode="basic" customUpload="true" chooseLabel="photos" uploadLabel="Valider" invalidFileSizeMessageDetail="Taille de l'image" accept=".png, .jpg, .jpeg" maxFileSize="1000000" (uploadHandler)="onBasicUpload($event, form)" ></p-fileUpload>
                                        </div>
                                        <div class="p-mr-2 p-mb-2">
                                            <p-fileUpload #form2 mode="basic" customUpload="true" chooseLabel="image" uploadLabel="Valider"  multiple="multiple" name="demo2[]" accept=".png, .jpg, .jpeg" maxFileSize="100000000" (uploadHandler)="onBasicUploadLot($event, form2)"></p-fileUpload>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-grid">
                                    
                                    <div class="p-col-9">
                                        
                                            <span class="p-input-icon-left">
                                                <i class="pi pi-search"></i>
                                                <input pInputText type="text"
                                                       (input)="dt.filterGlobal($event.target.value, 'contains')"
                                                       placeholder="Rechercher..." [style]="{width: '20%'}"/>
                                            </span>
                                    </div>
                                    <div class="p-col-2">
                                            <span class="p-input-icon-right">
                                                <button [disabled]="!historiqueAvenantAdherent1s" pButton pRipple icon="pi pi-print" label="Imprimer"
                                                        pTooltip="Imprimer la liste"
                                                        class="p-button-info"
                                                        (click)="onAdherentPrintAffaireNouvelle(historiqueAvenant)">
                                                </button>
                                            </span>
                                    </div>
                                    <div class="p-col-2">
                                        <span class="p-input-icon-right">
                                            <button [disabled]="!historiqueAvenantAdherent1s" pButton pRipple icon="pi pi-print" label="Par groupe"
                                                    pTooltip="Appuyer pour choisir le groupe"
                                                    class="p-button-info"
                                                    (click)="impAssureGroupe()">
                                            </button>
                                        </span>
                                </div>
                                </div>

                            </div>
                        </ng-template>

                        <ng-template pTemplate="header">
                            <tr>
                                <th style="width: 3rem">
                                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                </th>
                                <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold; width: 5rem">Matricule
                                    <p-sortIcon field="numero"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold; width: 5rem">Matricule Garant
                                    <p-sortIcon field="numeroGarant"></p-sortIcon>
                                </th>
                                <th pSortableColumn="nom" style="width: 12rem">Nom
                                    <p-sortIcon field="nom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="prenom" style="width: 12rem">Prenom
                                    <p-sortIcon field="prenom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numero" style="width: 8rem">Date de Naissance
                                    <p-sortIcon field="dateNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="lieuNaissance" style="width: 8rem">Lieu de naissance
                                    <p-sortIcon field="lieuNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroTelephone" style="width: 10rem">Telephone
                                    <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                </th>
                                <th pSortableColumn="dateIncorporation" style="width: 10rem">Groupe
                                    <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                </th>
<!--                                &lt;!&ndash;<th pSortableColumn="adresse" style="width: 10rem">Date Avenant
<!--                                    <p-sortIcon field="adresse"></p-sortIcon>-->
<!--                                </th>&ndash;&gt;-->
                                <th pSortableColumn="qla" style="width: 10rem">Qualité Assuré
                                    <p-sortIcon field="qla"></p-sortIcon>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-adherentHis>
                            <tr [ngClass]="{'colorZone': !adherentHis?.adherent?.adherentPrincipal}">
                                <td>
                                    <p-tableCheckbox [value]="adherentHis"></p-tableCheckbox>
                                </td>

                                <td><span class="p-column-title">{{adherentHis?.adherent?.numero}}</span></td>
                                <td><span class="p-column-title">{{adherentHis?.adherent?.matriculeGarant}}</span></td>
                                <td><span class="p-column-title">{{adherentHis?.adherent?.nom}}</span></td>
                                <td><span class="p-column-title">{{adherentHis?.adherent?.prenom}}</span></td>
                                <td><span
                                        class="p-column-title">{{adherentHis?.adherent?.dateNaissance | formatTableValue : 'date'}}</span>
                                </td>
                                <td><span class="p-column-title">{{adherentHis?.adherent?.lieuNaissance}}</span></td>
                                <td><span class="p-column-title">{{adherentHis?.adherent?.numeroTelephone}}</span>
                                </td>
                                <td><span class="p-column-title">{{adherentHis?.adherent?.groupe?.libelle}}</span>
                                </td>
                                <td><span
                                        class="p-column-title">{{adherentHis?.adherent?.qualiteAssure?.libelle}}</span>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            <div class="p-d-flex p-ai-center p-jc-between">
                                {{historiqueAvenantAdherent1s ? historiqueAvenantAdherent1s.length : 0 }} assuré(s).
                            </div>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </ng-template>
    </p-dialog>

    <!--Affichage des details des avenants de renouvellement -->
    <p-dialog [maximizable]="true" [(visible)]="displayDialogFormAdherentrenouvellement"
              header="Détails de l'avenant de renouvellement" [modal]="true" styleClass="p-fluid"
              [style]="{'width':'1400px'}">
    <p-tabView>
        <p-tabPanel header="INFOS" leftIcon="pi pi-users" tooltip="Information sur la police" [style]="{'width': '100%'}">
            <div>
                <span style="color: green !important"> <h4> Informations sur la police numéro <mark>{{historiqueAvenant?.police?.numero}}</mark>  de la société <mark>{{historiqueAvenant?.police?.nom}}</mark> </h4></span>
                <br>
                <p-fieldset legend="Police" toggleable="true">
                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-col">
                            <label for="lastname2">Garant</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.garant?.nom}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Intermediaire</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.intermediaire?.nom}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Taux de couverture</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.taux?.taux}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="firstname2">Territorialité</label>
                            <div>
                                <span *ngFor="let t of historiqueAvenant?.police?.territorialite">{{t.libelle}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="dateEffet">Date effet</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.dateEffet}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col-4">
                            <label for="lastname2">Date echeance</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.dateEcheance}}</span>
                            </div>
                        </div>

                    </div>

                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-col">
                            <label for="firstname2">Nom du souscripteur</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.nom}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Contact</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.contact}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="firstname2">Adresse email</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.adresseEmail}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="adressePostale">Adresse postale</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.adressePostale}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Secteur activite</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.secteurActivite?.libelle}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Numero IFU</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.numeroIfu}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="lastname2">Personne ressource</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.personneRessource}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Contact personne ressource</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.contactPersonneRessource}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="refPolice">Reference police</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.referencePolice}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col">
                            <label for="lastname2">Rccm</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.rccm}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Numero police</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.numero}}</span>
                            </div>
                        </div>

                        <div class="p-field p-col">
                            <label for="lastname2">Secteur</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.secteur?.libelle}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-fluid p-formgrid p-grid">

                        <div class="p-field p-col-4">
                            <label for="fraisAccessoire">Frais accessoire</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.fraisAccessoire | formatTableValue: 'number':true}}</span>
                            </div>
                        </div>
                        <div class="p-field p-col-4">
                            <label for="fraisBadge">Frais badge</label>
                            <div>
                                <span>{{historiqueAvenant?.police?.fraisBadge | formatTableValue: 'number':true}}</span>
                            </div>
                        </div>
                    </div>
                </p-fieldset>
            </div>
        </p-tabPanel>
        <p-tabPanel [style]="{'width': '100%'}" header="GROUPE" leftIcon="pi pi-users" tooltip="Groupe">
            <span style="color: green !important"> <h4> Informations sur le(s) groupe(s) de l'avenant</h4></span>
        </p-tabPanel>
        <p-tabPanel header="PLAFOND" leftIcon="pi pi-user-edit" tooltip="PLAFOND">
            <span style="color: green !important"> <h4> Informations sur les plafonds de l'avenant</h4></span>
                <ng-template pTemplate="content">
                    <p-table #dtConfigurationPlafond [value]="avenantModif.plafondFamilleActes" dataKey="garantie.id" editMode="row" responsiveLayout="scroll">
                        <ng-template pTemplate="header">
                            <tr>
                                <th></th>
                                <th>Famille acte</th>
                                <th>Prime</th>
                                <th>Taux</th>
                                <th>Date effet</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-plafond let-editing="editing" let-ri="rowIndex" let-expanded="expanded" >
                            <tr>
                                <td>
                                    <button type="button" pButton pRipple [pRowToggler]="plafond" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                                </td>

                                <td>{{plafond.garantie.libelle}}</td>


                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="plafond.montantPlafond" [value]="plafond.montantPlafond | formatTableValue: 'number':true" required>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{plafond.montantPlafond}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>

                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <p-dropdown [options]="tauxList" [(ngModel)]="plafond.taux" optionLabel="taux" placeholder="Select Make"
                                                        [style]="{'width':'100%'}"></p-dropdown>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{plafond?.taux.taux}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>
                                <td>{{plafond.dateEffet | formatTableValue : 'date'}}</td>
                                <td style="text-align:center">
                                    <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info" (click)="onRowEditInitPlafondConfiguration(plafond)"></button>
                                    <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check" class="ui-button-success" style="margin-right: .5em" (click)="onRowEditSavePlafondConfiguration(plafond)"></button>
                                    <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger" (click)="onRowEditCancelPlafondConfiguration(plafond, ri)"></button>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="rowexpansion" let-plafond>
                            <tr >
                                <td colspan="5">
                                    <div class="">
                                        <p-table [value]="avenantModif.plafondGroupeActes" dataKey="id">
                                        </p-table>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                            <ng-template pTemplate="body" let-acte let-expanded="expanded">
                                <tr>
                                    <td> <button type="button" pButton pRipple [pRowToggler]="acte" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button></td>
                                    <td>{{acte?.acte?.libelle}}</td>
                                    <td>{{acte?.montantPlafond}}</td>
                                    <td>{{acte?.taux?.taux}}</td>
                                    <td>{{acte?.dateEffet | formatTableValue : 'date'}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="rowexpansion" let-acte>
                                <tr>
                                    <td colspan="5">
                                        <div class="">
                                            <p-table [value]="acte.listeSousActe" dataKey="id">
                                            </p-table>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                </tr>
                                <ng-template pTemplate="body" let-sousActe let-expanded="expanded">
                                    <tr>
                                        <td></td>
                                        <td>{{sousActe?.sousActe?.libelle}}</td>
                                        <td>{{sousActe?.montantPlafond}}</td>
                                        <td>{{sousActe?.taux?.taux}}</td>
                                        <td>{{sousActe.dateEffet | formatTableValue : 'date'}}</td>
                                    </tr>
                                </ng-template>
                            </ng-template>
                        </ng-template>
                    </p-table>
                </ng-template>
        </p-tabPanel>

        <p-tabPanel header="ADHERENT" leftIcon="pi pi-user-edit" tooltip="ADHERANT">
            <span style="color: green !important"> <h4> Informations portant sur liste actualisée des adherents de l'avenant</h4></span>
                <div class="card">
                    <p-table #dtAL [value]="avenantModif.adhrents" [columns]="colsAL" [rows]="10" [paginator]="true"
                             [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                             [rowHover]="true" dataKey="id" [exportFilename]="'liste actualisée'" csvSeparator=";"
                             styleClass="p-datatable-customers"
                             currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                             [showCurrentPageReport]="true">
                        <ng-template pTemplate="caption">
                            <div class="table-header">
                                <h5 class="p-m-0"></h5>
                                <div class="p-grid">
                                    <div class="p-col-8">
                                <span class="p-input-icon-left">
                                    <i class="pi pi-search"></i>
                                    <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                           placeholder="Search..." [style]="{width: '20%'}"/>
                                </span>

                                    </div>
                                    <!--<div class="p-col-2">
                                        <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                            <button pButton pRipple label="Exporter" icon="pi pi-upload" class="p-button-help"
                                                    (click)="dtAL.exportCSV()"></button>
                                        </div>
                                    </div>-->
                                    <div class="p-col-2">
                                        <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                            <button pButton pRipple label="Imprimer" (click)="printListeActualisee(historiqueAvenant)" icon="pi pi-print" class="p-button-info">

                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template pTemplate="header">
                            <tr>
                                <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                    <p-sortIcon field="numero"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                                    <p-sortIcon field="numeroGarant"></p-sortIcon>
                                </th>
                                <th pSortableColumn="nom">Nom
                                    <p-sortIcon field="nom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="prenom" style="width: 12rem">Prenom
                                    <p-sortIcon field="prenom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresseEmail">Date de naissance
                                    <p-sortIcon field="dateNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresseEmail">Email
                                    <p-sortIcon field="adresseEmail"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroTelephone">Téléphone
                                    <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                </th>
                                <th pSortableColumn="genre">Genre
                                    <p-sortIcon field="genre.libelle"></p-sortIcon>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-adherent>
                            <tr [ngClass]="{'colorZone': !adherent?.adherentPrincipal}">
                                <td><span class="p-column-title">{{adherent?.numero}}</span></td>
                                <td><span class="p-column-title">{{adherent?.matriculeGarant}}</span></td>
                                <td><span class="p-column-title">{{adherent?.adherent?.nom}}</span>
                                <td><span class="p-column-title">{{adherent?.nom}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.prenom}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.dateNaissance}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.email}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.numeroTelephone}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.genre?.libelle}}</span></td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            <div class="p-d-flex p-ai-center p-jc-between">
                                {{avenantModif.adhrents ? avenantModif.adhrents.length : 0 }} adherent(s).
                            </div>
                        </ng-template>
                    </p-table>
                </div>


            <div class="p-col-12">

            </div>
        </p-tabPanel>

        <p-tabPanel header="INCORPORATION" leftIcon="pi pi-cog" tooltip="liste des personnes incorporées">
            <div class="p-grid">
                <div class="p-col-10">
                    <span style="color: green !important"> <h4> Informations portant sur les adherents incorporés dans l'avenant</h4></span>
                </div>
                <div class="p-col-2">
                    <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                        <button pButton pRipple label="Imprimer" (click)="onAdherentPrint4(historiqueAvenant)" icon="pi pi-print" class="p-button-info">

                        </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <p-table #dtAL [value]="avenantModif.historiqueAvenantAdherants" [columns]="colsAL" [rows]="10" [paginator]="true"
                         [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                         [rowHover]="true" dataKey="id" [exportFilename]="'liste actualisée'" csvSeparator=";"
                         styleClass="p-datatable-customers"
                         currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                         [showCurrentPageReport]="true">
                    <ng-template pTemplate="caption">
                        <div class="table-header">
                            <h5 class="p-m-0"></h5>

                        </div>
                    </ng-template>

                    <ng-template pTemplate="header">
                        <tr>
                            <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                <p-sortIcon field="numero"></p-sortIcon>
                            </th>
                            <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                                <p-sortIcon field="numeroGarant"></p-sortIcon>
                            </th>
                            <th pSortableColumn="nom">Nom
                                <p-sortIcon field="nom"></p-sortIcon>
                            </th>
                            <th pSortableColumn="prenom" style="width: 12rem">Prenom
                                <p-sortIcon field="prenom"></p-sortIcon>
                            </th>
                            <th pSortableColumn="adresseEmail">Date de Naissance
                                <p-sortIcon field="dateNaissance"></p-sortIcon>
                            </th>
                            <th pSortableColumn="adresseEmail">Email
                                <p-sortIcon field="adresseEmail"></p-sortIcon>
                            </th>
                            <th pSortableColumn="numeroTelephone">Téléphone
                                <p-sortIcon field="numeroTelephone"></p-sortIcon>
                            </th>
                            <th pSortableColumn="genre" style="width: 12rem">Genre
                                <p-sortIcon field="genre.libelle"></p-sortIcon>
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowdata>
                        <tr [ngClass]="{'colorZone': !rowdata?.adherent?.adherentPrincipal}">
                            <td><span class="p-column-title">{{rowdata?.numero}}</span></td>
                            <td><span class="p-column-title">{{rowdata?.matriculeGarant}}</span></td>
                            <td><span class="p-column-title">{{rowdata?.adherent?.nom}}</span>

                            </td>
                            <td><span class="p-column-title">{{rowdata?.adherent?.prenom}}</span>

                            </td>
                            <td><span class="p-column-title">{{rowdata?.adherent?.dateNaissance}}</span>

                            </td>
                            <td><span class="p-column-title">{{rowdata?.adherent?.email}}</span>

                            </td>
                            <td><span class="p-column-title">{{rowdata?.adherent?.numeroTelephone}}</span>

                            </td>
                            <td><span class="p-column-title">{{rowdata?.adherent?.genre?.libelle}}</span></td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="summary">
                        <div class="p-d-flex p-ai-center p-jc-between">
                            {{avenantModif.historiqueAvenantAdherants ? avenantModif.historiqueAvenantAdherants.length : 0 }} adherent(s).
                        </div>
                    </ng-template>
                </p-table>
            </div>


        </p-tabPanel>
        <p-tabPanel header="RETRAIT" leftIcon="pi pi-cog" tooltip="liste des personnes retirées">
            <span style="color: green !important"> <h4> Informations portant sur les adherents retirés dans l'avenant</h4></span>
            <p-table #dtAL [value]="avenantModif.historiqueAvenantAdherantDels" [columns]="colsAL" [rows]="10" [paginator]="true"
                     [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                     [rowHover]="true" dataKey="id" [exportFilename]="'liste actualisée'" csvSeparator=";"
                     styleClass="p-datatable-customers"
                     currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                     [showCurrentPageReport]="true">


                <ng-template pTemplate="header">
                    <tr>
                        <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                            <p-sortIcon field="numero"></p-sortIcon>
                        </th>
                        <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                            <p-sortIcon field="numeroGarant"></p-sortIcon>
                        </th>
                        <th pSortableColumn="nom">Nom
                            <p-sortIcon field="nom"></p-sortIcon>
                        </th>
                        <th pSortableColumn="prenom" style="width: 12rem">Prenom
                            <p-sortIcon field="prenom"></p-sortIcon>
                        </th>
                        <th pSortableColumn="adresseEmail">Date de naissance
                            <p-sortIcon field="dateNaissance"></p-sortIcon>
                        </th>
                        <th pSortableColumn="adresseEmail">Email
                            <p-sortIcon field="adresseEmail"></p-sortIcon>
                        </th>
                        <th pSortableColumn="numeroTelephone">Téléphone
                            <p-sortIcon field="numeroTelephone"></p-sortIcon>
                        </th>
                        <th pSortableColumn="genre" style="width: 12rem">Genre
                            <p-sortIcon field="genre.libelle"></p-sortIcon>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-adherent>
                    <tr [ngClass]="{'colorZone': !adherent?.adherentPrincipal}">
                        <td><span class="p-column-title">{{adherent.numero}}</span></td>
                        <td><span class="p-column-title">{{adherent.matriculeGarant}}</span></td>
                        <td><span class="p-column-title">{{adherent?.nom}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.prenom}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.dateNaissance}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.email}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.numeroTelephone}}</span>

                        </td>
                        <td><span class="p-column-title">{{adherent?.genre?.libelle}}</span></td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="summary">
                    <div class="p-d-flex p-ai-center p-jc-between">
                        {{avenantModif.historiqueAvenantAdherantDels ? avenantModif.historiqueAvenantAdherantDels.length : 0 }} adherent(s).
                    </div>
                </ng-template>
            </p-table>

        </p-tabPanel>

    </p-tabView>
        </p-dialog>

    <!--Affichage des details des avenants de modification -->
    <p-dialog [maximizable]="true" [(visible)]="displayDialogFormAdherentModification"
              header="Détails de l'avenant de modification" [modal]="true" styleClass="p-fluid"
              [style]="{'width':'1400px'}">
        <p-tabView>
            <p-tabPanel header="INFOS" leftIcon="pi pi-users" tooltip="Information sur la police" [style]="{'width': '100%'}">
                <div>
                    <span style="color: green !important"> <h4> Informations sur la police numéro <mark>{{historiqueAvenant?.police?.numero}}</mark>  de la société <mark>{{historiqueAvenant?.police?.nom}}</mark> </h4></span>
                    <br>
                    <p-fieldset legend="Police" toggleable="true">
                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="lastname2">Garant</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.garant?.nom}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Intermediaire</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.intermediaire?.nom}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Taux de couverture</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.taux?.taux}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="firstname2">Territorialité</label>
                                <div>
                                    <span *ngFor="let t of historiqueAvenant?.police?.territorialite">{{t.libelle}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="dateEffet">Date effet</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.dateEffet}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col-4">
                                <label for="lastname2">Date echeance</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.dateEcheance}}</span>
                                </div>
                            </div>

                        </div>

                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="firstname2">Nom du souscripteur</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.nom}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Contact</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.contact}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="firstname2">Adresse email</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.adresseEmail}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="adressePostale">Adresse postale</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.adressePostale}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Secteur activite</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.secteurActivite?.libelle}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Numero IFU</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.numeroIfu}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Personne ressource</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.personneRessource}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Contact personne ressource</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.contactPersonneRessource}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="refPolice">Reference police</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.referencePolice}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Rccm</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.rccm}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Numero police</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.numero}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Secteur</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.secteur?.libelle}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col-4">
                                <label for="fraisAccessoire">Frais accessoire</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.fraisAccessoire | formatTableValue: 'number':true}}</span>
                                </div>
                            </div>
                            <div class="p-field p-col-4">
                                <label for="fraisBadge">Frais badge</label>
                                <div>
                                    <span>{{historiqueAvenant?.police?.fraisBadge | formatTableValue: 'number':true}}</span>
                                </div>
                            </div>
                        </div>
                    </p-fieldset>
                </div>
            </p-tabPanel>
            <p-tabPanel [style]="{'width': '100%'}" header="GROUPE" leftIcon="pi pi-users" tooltip="Groupe">
                <span style="color: green !important"> <h4> Informations sur le(s) groupe(s) de l'avenant</h4></span>
            </p-tabPanel>
            <p-tabPanel header="PLAFOND" leftIcon="pi pi-user-edit" tooltip="PLAFOND">
                <span style="color: green !important"> <h4> Informations sur les plafonds de l'avenant</h4></span>
                <ng-template pTemplate="content">
                    <p-table #dtConfigurationPlafond [value]="avenantModif1.plafondFamilleActes" dataKey="garantie.id" editMode="row" responsiveLayout="scroll">
                        <ng-template pTemplate="header">
                            <tr>
                                <th></th>
                                <th>Famille acte</th>
                                <th>Prime</th>
                                <th>Taux</th>
                                <th>Date effet</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-plafond let-editing="editing" let-ri="rowIndex" let-expanded="expanded" >
                            <tr>
                                <td>
                                    <button type="button" pButton pRipple [pRowToggler]="plafond" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                                </td>

                                <td>{{plafond.garantie.libelle}}</td>


                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="plafond.montantPlafond" [value]="plafond.montantPlafond | formatTableValue: 'number':true" required>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{plafond.montantPlafond}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>

                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <p-dropdown [options]="tauxList" [(ngModel)]="plafond.taux" optionLabel="taux" placeholder="Select Make"
                                                        [style]="{'width':'100%'}"></p-dropdown>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{plafond?.taux.taux}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>
                                <td>{{plafond.dateEffet | formatTableValue : 'date'}}</td>
                                <td style="text-align:center">
                                    <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info" (click)="onRowEditInitPlafondConfiguration(plafond)"></button>
                                    <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check" class="ui-button-success" style="margin-right: .5em" (click)="onRowEditSavePlafondConfiguration(plafond)"></button>
                                    <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger" (click)="onRowEditCancelPlafondConfiguration(plafond, ri)"></button>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="rowexpansion" let-plafond>
                            <tr >
                                <td colspan="5">
                                    <div class="">
                                        <p-table [value]="avenantModif.plafondGroupeActes" dataKey="id">
                                        </p-table>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                            <ng-template pTemplate="body" let-acte let-expanded="expanded">
                                <tr>
                                    <td> <button type="button" pButton pRipple [pRowToggler]="acte" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button></td>
                                    <td>{{acte?.acte?.libelle}}</td>
                                    <td>{{acte?.montantPlafond}}</td>
                                    <td>{{acte?.taux?.taux}}</td>
                                    <td>{{acte?.dateEffet | formatTableValue : 'date'}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="rowexpansion" let-acte>
                                <tr>
                                    <td colspan="5">
                                        <div class="">
                                            <p-table [value]="acte.listeSousActe" dataKey="id">
                                            </p-table>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                </tr>
                                <ng-template pTemplate="body" let-sousActe let-expanded="expanded">
                                    <tr>
                                        <td></td>
                                        <td>{{sousActe?.sousActe?.libelle}}</td>
                                        <td>{{sousActe?.montantPlafond}}</td>
                                        <td>{{sousActe?.taux?.taux}}</td>
                                        <td>{{sousActe.dateEffet | formatTableValue : 'date'}}</td>
                                    </tr>
                                </ng-template>
                            </ng-template>
                        </ng-template>
                    </p-table>
                </ng-template>
            </p-tabPanel>

            <p-tabPanel header="ADHERENT" leftIcon="pi pi-user-edit" tooltip="ADHERANT">
                <span style="color: green !important"> <h4> Informations portant sur liste actualisée des adherents de l'avenant</h4></span>
                <div class="card">
                    <p-table #dtAL [value]="avenantModif1.adhrents" [columns]="colsAL" [rows]="10" [paginator]="true"
                             [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                             [rowHover]="true" dataKey="id" [exportFilename]="'liste actualisée'" csvSeparator=";"
                             styleClass="p-datatable-customers"
                             currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                             [showCurrentPageReport]="true">
                        <ng-template pTemplate="caption">
                            <div class="table-header">
                                <h5 class="p-m-0"></h5>
                                <div class="p-grid">
                                    <div class="p-col-8">
                                <span class="p-input-icon-left">
                                    <i class="pi pi-search"></i>
                                    <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                           placeholder="Search..." [style]="{width: '20%'}"/>
                                </span>

                                    </div>
                                    <div class="p-col-2">
                                        <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                            <button pButton pRipple label="Exporter" icon="pi pi-upload" class="p-button-help"
                                                    (click)="dtAL.exportCSV()"></button>
                                        </div>
                                    </div>
                                    <div class="p-col-2">
                                        <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                            <button pButton pRipple label="Imprimer" icon="pi pi-print" class="p-button-info">

                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template pTemplate="header">
                            <tr>
                                <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                    <p-sortIcon field="numero"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                                    <p-sortIcon field="numeroGarant"></p-sortIcon>
                                </th>
                                <th pSortableColumn="nom">Nom
                                    <p-sortIcon field="nom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="prenom" style="width: 12rem">Prenom
                                    <p-sortIcon field="prenom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresseEmail">Date de naissance
                                    <p-sortIcon field="dateNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresseEmail">Email
                                    <p-sortIcon field="adresseEmail"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroTelephone">Téléphone
                                    <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                </th>
                                <th pSortableColumn="genre" style="width: 12rem">Genre
                                    <p-sortIcon field="genre.libelle"></p-sortIcon>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-adherent>
                            <tr [ngClass]="{'colorZone': !adherent?.adherentPrincipal}">
                                <td><span class="p-column-title">{{adherent.numero}}</span></td>
                                <td><span class="p-column-title">{{adherent.matriculeGarant}}</span></td>
                                <td><span class="p-column-title">{{adherent?.nom}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.prenom}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.dateNaissance}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.email}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.numeroTelephone}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.genre?.libelle}}</span></td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            <div class="p-d-flex p-ai-center p-jc-between">
                                {{avenantModif.adhrents ? avenantModif.adhrents.length : 0 }} adherent(s).
                            </div>
                        </ng-template>
                    </p-table>
                </div>


                <div class="p-col-12">

                </div>
            </p-tabPanel>
        </p-tabView>
    </p-dialog>

    <p-dialog [maximizable]="true" [(visible)]="displayDialogPrime" (onHide)="annulerPrime()"
    header="VISUALISATION DES PRIMES" [modal]="true" styleClass="p-fluid" [style]="{'width':'1200px'}">
<ng-template pTemplate="content">
  <div class="">
      <div class="card">
          <p-table #dt [value]="historiqueAvenantPrimes" [columns]="cols" [rows]="10" editMode="row" [rowHover]="true" dataKey="id">
              <ng-template pTemplate="header">
                  <tr>
                      <th pSortableColumn="nom">Groupe
                          <p-sortIcon field="nom"></p-sortIcon>
                      </th>
                      <th pSortableColumn="nom" >Type Prime
                          <p-sortIcon field="nom"></p-sortIcon>
                      </th>
                      <!--<th pSortableColumn="nom">Frais accessoire
                          <p-sortIcon field="nom"></p-sortIcon>
                      </th>
                      <th pSortableColumn="nom">Frais badge
                          <p-sortIcon field="nom"></p-sortIcon>
                      </th>-->
                      <th pSortableColumn="prenom">prime
                          <p-sortIcon field="prenom"></p-sortIcon>
                      </th>
                      <th pSortableColumn="numero">Prime Nette
                          <p-sortIcon field="dateNaissance"></p-sortIcon>
                      </th>
                      <!--<th pSortableColumn="numero" style="width: 12rem">Taxe
                          <p-sortIcon field="dateNaissance"></p-sortIcon>
                      </th>-->
                      <th pSortableColumn="lieuNaissance">Prime Totale
                          <p-sortIcon field="lieuNaissance"></p-sortIcon>
                      </th>
                      <th>Actions</th>
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-historiqueAvenantPrime let-editing="editing" let-ri="rowIndex">
                  <tr [pEditableRow]="historiqueAvenantPrime" *ngIf="historiqueAvenantPrime.groupe" style="font-size: large; height: 5em">
                      <td><span>{{historiqueAvenantPrime.groupe?.libelle}}</span></td>
                      <td><span>{{historiqueAvenantPrime.typePrime?.libelle}}</span></td>
                      <!--<td><span>{{historiqueAvenantPrime.fraisAccessoir | formatTableValue: 'number':true}}</span></td>
                      <td><span>{{historiqueAvenantPrime.fraisBadge | formatTableValue: 'number':true}}</span></td>-->
                      <td>
                          <span *ngIf="historiqueAvenantPrime?.groupe?.typePrime.code === 'PAE'">
                              Prime Adulte : <span style="font-weight: bold">{{historiqueAvenantPrime.primeAdulte | formatTableValue: 'number':true}} </span> <br>
                              Prime Enfant :<span style="font-weight: bold">{{historiqueAvenantPrime.primeEnfant | formatTableValue: 'number':true}} </span>
                          </span>
                          <span *ngIf="historiqueAvenantPrime?.groupe?.typePrime.code === 'PECE'">
                              Prime Employée : <span style="font-weight: bold">{{historiqueAvenantPrime.primeEmploye | formatTableValue: 'number':true}} </span> <br>
                              Prime Enfant : <span style="font-weight: bold">{{historiqueAvenantPrime.primeEnfant | formatTableValue: 'number':true}}</span> <br>
                              Prime Conjoint : <span style="font-weight: bold">{{historiqueAvenantPrime.primeConjoint | formatTableValue: 'number':true}}</span>
                          </span>
                          <span *ngIf="historiqueAvenantPrime?.groupe?.typePrime.code === 'PP'">
                              Prime Personne : <span style="font-weight: bold">{{historiqueAvenantPrime.primePersonne | formatTableValue: 'number':true}} </span> <br>
                          </span>
                          <span *ngIf="historiqueAvenantPrime?.groupe?.typePrime.code === 'PF'">
                              Prime Famille : <span style="font-weight: bold">{{historiqueAvenantPrime.primeFamille | formatTableValue: 'number':true}} </span> <br>
                          </span>
                          <span *ngIf="historiqueAvenantPrime?.groupe?.typePrime.code === 'PE'">
                              Prime Employée : <span style="font-weight: bold">{{historiqueAvenantPrime.primeEmploye | formatTableValue: 'number':true}} </span> <br>
                          </span>
                      </td>
                      <td>
                          <p-cellEditor>
                              <ng-template pTemplate="input">
                                  <input pInputText type="text"
                                         [(ngModel)]="historiqueAvenantPrime.primeNet" [value]="historiqueAvenantPrime.primeNet | formatTableValue: 'number':true"
                                  (change)="onChangePrimeNet()">
                              </ng-template>
                              <ng-template pTemplate="output">
                                  <span style="font-weight: bold">{{historiqueAvenantPrime.primeNet | formatTableValue: 'number':true}}</span>
                              </ng-template>
                          </p-cellEditor>
                      </td>
                      <!--<td><span style="font-weight: bold">{{historiqueAvenantPrime.taxeTTC | formatTableValue: 'number':true}}</span></td>-->
                      <td>
                          <p-cellEditor>
                              <ng-template pTemplate="input">
                                  <input pInputText type="text"
                                         [(ngModel)]="historiqueAvenantPrime.primeTotal" [value]="historiqueAvenantPrime.primeTotal | formatTableValue: 'number':true"
                                         (change)="onChangePrimeNet()">
                              </ng-template>
                              <ng-template pTemplate="output">
                                  <span style="font-weight: bold">{{historiqueAvenantPrime.primeTotal | formatTableValue: 'number':true}}</span>
                              </ng-template>
                          </p-cellEditor>
                      </td>
                      <td>
                          <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info"
                                  (click)="onRowEditInitPrime(historiqueAvenantPrime)" [disabled]="historiqueAvenantPrime.status"></button>
                          <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check" class="ui-button-success"
                                  style="margin-right: .5em" (click)="onRowEditSavePrime(historiqueAvenantPrime)"></button>
                          <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger"
                                  (click)="onRowEditCancelPrime(historiqueAvenantPrime, ri)"></button>
                      </td>
                  </tr>
                  <tr *ngIf="!historiqueAvenantPrime.groupe"
                      style="background-color: lightcyan; color: #27a22d; font-weight: bold; font-size: large; height: 4em; border-radius: 1em">
                      <td>Frais Badges <br> {{historiqueAvenantPrime.fraisBadge | formatTableValue: 'number':true}}</td>
                      <td>Frais Accessoires <br> {{historiqueAvenantPrime.fraisAccessoir | formatTableValue: 'number':true}}</td>
                      <td colspan="2">Prime nette Totale <br> {{historiqueAvenantPrime.primeNet | formatTableValue: 'number':true}}</td>
                      <td colspan="1">Prime totale HT <br> {{historiqueAvenantPrime.primeTotal | formatTableValue: 'number':true}}</td>
                      <td>
                          <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info" (click)="onRowEditInitPrime(historiqueAvenantPrime)"></button>
                          <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check" class="ui-button-success" style="margin-right: .5em" (click)="onRowEditSavePrime(historiqueAvenantPrime)"></button>
                          <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger" (click)="onRowEditCancelPrime(historiqueAvenantPrime, ri)"></button>
                      </td>
                  </tr>
              </ng-template>
              <!--<ng-template pTemplate="summary">
                  <div style="text-align: center; font-weight: bold; color: #0cca16; font-size: 1.5em">
                      Prime Total de l'avenant : {{historiqueAvenantPrimes[0].historiqueAvenant.typeHistoriqueAvenant}}
                  </div>
              </ng-template>-->
          </p-table>
          <div class="p-grid mt-3">
              <div class="p-col-3"></div>
              <div class="p-col-2">
                  <button pButton pRipple label="Annuler Prime" icon="pi pi-times" class="p-button p-button-danger" type="button"
                              (click)="annulerPrime()">
                  </button>
              </div>
              <div class="p-col-2">
                  <button type="button" pButton pRipple label="Valider Prime" icon="pi pi-save" class="p-button p-button-success"
                      (click)="validerPrime( historiqueAvenantPrimes[0].historiqueAvenant)" [disabled]="historiqueAvenantPrimes[0].status">
                  </button>
              </div>
          </div>
      </div>
  </div>
</ng-template>
</p-dialog>

    <!--Affichage des details des avenants de résiliation -->
    <p-dialog [maximizable]="true" [(visible)]="displayDialogFormAdherentResiliation"
              header="Adhérent(s) et membre(s) de familles résilié(s)" [modal]="true" styleClass="p-fluid"
              [style]="{'width':'1400px'}">
        <ng-template pTemplate="content">
            <div class="">
                <div class="card">
                    <p-table #dt [value]="historiqueAvenantAdherents5" [columns]="cols" [rows]="10"
                             [paginator]="true"
                             [globalFilterFields]="['adherent.nom','adherent.prenom','adherent.telephone','adherent.lieuNaissance','adherent.qualiteAssure.libelle']"
                             [rowHover]="true" dataKey="id"
                             styleClass="p-datatable-customers"
                             currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                             [showCurrentPageReport]="true">
                        <ng-template pTemplate="caption">
                            <div class="p-d-flex p-flex-column table-header">
                                <div class="p-grid">
                                    <div class="p-col-9">
                                            <span class="p-input-icon-left">
                                                <i class="pi pi-search"></i>
                                                <input pInputText type="text"
                                                       (input)="dt.filterGlobal($event.target.value, 'contains')"
                                                       placeholder="Rechercher..." [style]="{width: '20%'}"/>
                                            </span>
                                    </div>
                                    <div class="p-col-2">
                                            <span class="p-input-icon-right">
                                                <button pButton pRipple icon="pi pi-print" label="Imprimer"
                                                        pTooltip="Imprimer la liste"
                                                        class="p-button-info"
                                                        (click)="onAdherentPrintResiliation(historiqueAvenant)"></button>
                                            </span>
                                    </div>
                                </div>

                            </div>
                        </ng-template>

                        <ng-template pTemplate="header">
                            <tr>
                                <!--<td><span class="p-column-title">{{historiqueAvenant.historiqueAvenant?.groupe?.libelle}}</span></td>
                                <td><span class="p-column-title">{{historiqueAvenant.typePrime?.libelle}}</span></td>
                                <td><span class="p-column-title">{{historiqueAvenant.primeNet}}</span></td>
                                <td><span class="p-column-title">{{historiqueAvenant.primeTotal}}</span></td>
                                <td><span class="p-column-title">{{historiqueAvenant.primeTotal}}</span></td>-->

                                <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                    <p-sortIcon field="numero"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                                    <p-sortIcon field="numeroGarant"></p-sortIcon>
                                </th>
                                <th pSortableColumn="nom" style="width: 7rem">Nom
                                    <p-sortIcon field="nom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="prenom" style="width: 9rem">Prenom
                                    <p-sortIcon field="prenom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numero" style="width: 12rem">Date Naissance
                                    <p-sortIcon field="dateNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="lieuNaissance" style="width: 12rem">Lieu de naissance
                                    <p-sortIcon field="lieuNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroTelephone" style="width: 10rem">Telephone
                                    <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresse" style="width: 10rem">Date Inc.
                                    <p-sortIcon field="adresse"></p-sortIcon>
                                </th>
                                <th pSortableColumn="qla" style="width: 10rem">Qualité Assuré
                                    <p-sortIcon field="qla"></p-sortIcon>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-adherentHis>
                            <tr [ngClass]="{'colorZone': !adherentHis?.adherent?.adherentPrincipal}">
                                <td><span class="p-column-title">{{adherentHis.adherent.numero}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.matriculeGarant}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.nom}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.prenom}}</span></td>
                                <td><span
                                        class="p-column-title">{{adherentHis.adherent.dateNaissance | formatTableValue : 'date'}}</span>
                                </td>
                                <td><span class="p-column-title">{{adherentHis.adherent.lieuNaissance}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.numeroTelephone}}</span>
                                </td>
                                <td><span class="p-column-title">{{adherentHis.adherent.dateIncorporation}}</span>
                                </td>
                                <td><span
                                        class="p-column-title">{{adherentHis.adherent.qualiteAssure.libelle}}</span>
                                </td>
                                <!-- <td>
                                    <button pButton pRipple icon="pi pi-pencil" pTooltip="editer" class="p-button-rounded p-button-success p-mr-2" (click)="modifierAdherent(adherent)"></button>
                                    <button pButton pRipple icon="pi pi-trash" pTooltip="Supprimer" class="p-button-rounded p-button-warning p-mr-2" (click)="supprimerAdherent(adherent)"></button>
                                    <button pButton pRipple icon="pi pi-eye" pTooltip="voir details" class="p-button-rounded p-button-warning" (click)="voirDetailAdherent(adherent)"></button>
                                </td> -->
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            <div class="p-d-flex p-ai-center p-jc-between">
                                {{historiqueAvenantAdherents5 ? historiqueAvenantAdherents5.length : 0 }} assuré(s).
                            </div>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </ng-template>
    </p-dialog>

    <!--Affichage des details des avenants de suspension -->
    <p-dialog [maximizable]="true" [(visible)]="displayDialogFormAdherentSuspension"
              header="Adhérent(s) et membre(s) de familles suspendu(s)" [modal]="true" styleClass="p-fluid"
              [style]="{'width':'1400px'}">
        <ng-template pTemplate="content">
            <div class="">
                <div class="card">
                    <p-table #dt [value]="historiqueAvenantAdherents6" [columns]="cols" [rows]="10"
                             [paginator]="true"
                             [globalFilterFields]="['adherent.nom','adherent.prenom','adherent.telephone','adherent.lieuNaissance','adherent.qualiteAssure.libelle']"
                             [rowHover]="true" dataKey="id"
                             styleClass="p-datatable-customers"
                             currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                             [showCurrentPageReport]="true">
                        <ng-template pTemplate="caption">
                            <div class="p-d-flex p-flex-column table-header">
                                <div class="p-grid">
                                    <div class="p-col-9">
                                            <span class="p-input-icon-left">
                                                <i class="pi pi-search"></i>
                                                <input pInputText type="text"
                                                       (input)="dt.filterGlobal($event.target.value, 'contains')"
                                                       placeholder="Rechercher..." [style]="{width: '20%'}"/>
                                            </span>
                                    </div>
                                    <div class="p-col-2">
                                            <span class="p-input-icon-right">
                                                <button pButton pRipple icon="pi pi-print" label="Imprimer"
                                                        pTooltip="Imprimer la liste"
                                                        class="p-button-info"
                                                        (click)="onAdherentPrintSuspension(historiqueAvenant)"></button>
                                            </span>
                                    </div>
                                </div>

                            </div>
                        </ng-template>

                        <ng-template pTemplate="header">
                            <tr>
                                <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                    <p-sortIcon field="numero"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroGarant" style="font-size: 12px !important; font-weight: bold;">Matricule Garant
                                    <p-sortIcon field="numeroGarant"></p-sortIcon>
                                </th>
                                <th pSortableColumn="nom" style="width: 7rem">Nom
                                    <p-sortIcon field="nom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="prenom" style="width: 10rem">Prenom
                                    <p-sortIcon field="prenom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numero" style="width: 12rem">Date Naissance
                                    <p-sortIcon field="dateNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="lieuNaissance" style="width: 12rem">Lieu de naissance
                                    <p-sortIcon field="lieuNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroTelephone" style="width: 10rem">Telephone
                                    <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresse" style="width: 10rem">Date Inc.
                                    <p-sortIcon field="adresse"></p-sortIcon>
                                </th>
                                <th pSortableColumn="qla" style="width: 10rem">Qualité Assuré
                                    <p-sortIcon field="qla"></p-sortIcon>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-adherentHis>
                            <tr [ngClass]="{'colorZone': !adherentHis?.adherent?.adherentPrincipal}">
                                <td><span class="p-column-title">{{adherentHis.adherent.numero}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.matriculeGarant}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.nom}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.prenom}}</span></td>
                                <td><span
                                        class="p-column-title">{{adherentHis.adherent.dateNaissance | formatTableValue : 'date'}}</span>
                                </td>
                                <td><span class="p-column-title">{{adherentHis.adherent.lieuNaissance}}</span></td>
                                <td><span class="p-column-title">{{adherentHis.adherent.numeroTelephone}}</span>
                                </td>
                                <td><span class="p-column-title">{{adherentHis.adherent.dateIncorporation}}</span>
                                </td>
                                <td><span
                                        class="p-column-title">{{adherentHis.adherent.qualiteAssure.libelle}}</span>
                                </td>
                                <!-- <td>
                                    <button pButton pRipple icon="pi pi-pencil" pTooltip="editer" class="p-button-rounded p-button-success p-mr-2" (click)="modifierAdherent(adherent)"></button>
                                    <button pButton pRipple icon="pi pi-trash" pTooltip="Supprimer" class="p-button-rounded p-button-warning p-mr-2" (click)="supprimerAdherent(adherent)"></button>
                                    <button pButton pRipple icon="pi pi-eye" pTooltip="voir details" class="p-button-rounded p-button-warning" (click)="voirDetailAdherent(adherent)"></button>
                                </td> -->
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            <div class="p-d-flex p-ai-center p-jc-between">
                                {{historiqueAvenantAdherents6 ? historiqueAvenantAdherents6.length : 0 }} assuré(s).
                            </div>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </ng-template>
    </p-dialog>

    <p-confirmDialog [style]="{width: '500px'}" acceptLabel="Oui" rejectLabel="Non"></p-confirmDialog>

    <p-dialog [maximizable]="false" [(visible)]="viewStat" header="Statistiques" [modal]="true" styleClass="p-fluid" [style]="{'width':'400px'}" (onHide)="hideStat()">
        <div class="p-fluid p-formgrid p-grid">
            <div class="p-field p-col-8 stat-item">Nombre d'adhérent : </div> <div class="p-field p-col-4 stat-count">{{stat?.nombreAdherent}}</div>
            <div class="p-field p-col-8 stat-item">Nombre de Conjoint(es)</div> <div class="p-field p-col-4 stat-count">{{stat?.nombreConjoint}}</div>
            <div class="p-field p-col-8 stat-item">Nombre d'Enfant(s)</div> <div class="p-field p-col-4 stat-count">{{stat?.nombreEnfant}}</div> <br>
            <div class="p-field p-col-12"><hr style="height:3px;border-width:0;color:gray;background-color:gray"></div>  
            <div class="p-field p-col-8 stat-item">Effectif total</div> <div class="p-field p-col-4 stat-count">{{stat?.total}}</div>
        </div>
    </p-dialog>

    <p-dialog [maximizable]="true" [(visible)]="displayViewContrat"
              header="Détails du contrat" [modal]="true" styleClass="p-fluid"
              [style]="{'width':'1400px'}">
        <p-tabView>
            <p-tabPanel header="INFOS" leftIcon="pi pi-users" tooltip="Information sur la police" [style]="{'width': '100%'}">
                <div>
                    <span style="color: green !important"> <h4> Informations sur la police numéro1 <mark>{{viewPolice?.numero}}</mark>  de la société <mark>{{viewPolice?.nom}}</mark> </h4></span>
                    <br>
                    <p-fieldset legend="Police" toggleable="true">
                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="lastname2">Garant</label>
                                <div>
                                    <span>{{viewPolice?.garant?.nom}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Intermediaire</label>
                                <div>
                                    <span>{{viewPolice?.intermediaire?.nom}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Taux de couverture</label>
                                <div>
                                    <span>{{viewPolice?.taux?.taux}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="firstname2">Territorialité</label>
                                <div>
                                    <span *ngFor="let t of viewPolice?.territorialite">{{t.libelle}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="dateEffet">Date effet</label>
                                <div>
                                    <span>{{viewPolice?.dateEffet}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col-4">
                                <label for="lastname2">Date echeance</label>
                                <div>
                                    <span>{{viewPolice?.dateEcheance}}</span>
                                </div>
                            </div>

                        </div>

                        <div class="p-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <label for="firstname2">Nom du souscripteur</label>
                                <div>
                                    <span>{{viewPolice?.nom}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Contact</label>
                                <div>
                                    <span>{{viewPolice?.contact}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="firstname2">Adresse email</label>
                                <div>
                                    <span>{{viewPolice?.adresseEmail}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="adressePostale">Adresse postale</label>
                                <div>
                                    <span>{{viewPolice?.adressePostale}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Secteur activite</label>
                                <div>
                                    <span>{{viewPolice?.secteurActivite?.libelle}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Numero IFU</label>
                                <div>
                                    <span>{{viewPolice?.numeroIfu}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Personne ressource</label>
                                <div>
                                    <span>{{viewPolice?.personneRessource}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Contact personne ressource</label>
                                <div>
                                    <span>{{viewPolice?.contactPersonneRessource}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="refPolice">Reference police</label>
                                <div>
                                    <span>{{viewPolice?.referencePolice}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col">
                                <label for="lastname2">Rccm</label>
                                <div>
                                    <span>{{viewPolice?.rccm}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Numero police</label>
                                <div>
                                    <span>{{viewPolice?.numero}}</span>
                                </div>
                            </div>

                            <div class="p-field p-col">
                                <label for="lastname2">Secteur</label>
                                <div>
                                    <span>{{viewPolice?.secteur?.libelle}}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-fluid p-formgrid p-grid">

                            <div class="p-field p-col-4">
                                <label for="fraisAccessoire">Frais accessoire</label>
                                <div>
                                    <span>{{viewPolice?.fraisAccessoire | formatTableValue: 'number':true}}</span>
                                </div>
                            </div>
                            <div class="p-field p-col-4">
                                <label for="fraisBadge">Frais badge</label>
                                <div>
                                    <span>{{viewPolice?.fraisBadge | formatTableValue: 'number':true}}</span>
                                </div>
                            </div>
                        </div>
                    </p-fieldset>
                </div>
            </p-tabPanel>
            <p-tabPanel [style]="{'width': '100%'}" header="GROUPE" leftIcon="pi pi-users" tooltip="Groupe">
                <span style="color: green !important"> <h4> Informations sur le(s) groupe(s) de l'avenant </h4></span>
                <ng-template pTemplate="content">
                    <p-table #dtConfigurationPlafond [value]="groupeView" dataKey="garantie.id" editMode="row" responsiveLayout="scroll">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>Numéro de groupe</th>
                                <th>Description</th>
                                <th>Libelle</th>
                            
                               
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-groupe let-editing="editing" >
                            <tr>
                                <td>{{groupe.libelle}}</td>
                                <td>{{groupe.numeroGroupe}}</td>
                                <td>{{groupe.description}}</td>
                            </tr>
                        </ng-template>
                    </p-table>

                </ng-template>
            </p-tabPanel>
            <p-tabPanel header="PLAFOND" leftIcon="pi pi-user-edit" tooltip="PLAFOND">
                <span style="color: green !important"> <h4> Informations sur les plafonds de l'avenant</h4></span>
                <ng-template pTemplate="content">
                    <div class="p-grid">
                        <div class="p-col-4">
                            <label class="p-fieldset-content">Choisir le Groupe</label>
                            <p-dropdown [options]="groupeView" optionLabel="libelle" [(ngModel)]="groupePlafongConfig"
                                        [filter]="true" filterBy="libelle" [showClear]="true"
                                        placeholder="Choisir un groupe"
                                        (onChange)="loadPlafondByGroupe(groupePlafongConfig)" [style]="{'width': '100%'}">
                            </p-dropdown>
                        </div>
                    </div>
                    <p-table #dtConfigurationPlafond [value]="avenantModif1.plafondFamilleActes" dataKey="garantie.id" editMode="row" responsiveLayout="scroll">
                        <ng-template pTemplate="header">
                            <tr>
                                <th></th>
                                <th>Famille acte</th>
                                <th>Montant plafonné / acte</th>
                                <th>Montant plafonné / periode</th>
                                <th>Periode</th>
                                <th>Nombre acte</th>
                                <th>Taux de couverture</th>
                                <th>Domaine</th>
                                <th>Date effet</th>
                                <th>Status</th>
                               <!--  <th>Famille acte</th>
                                <th>Prime</th>
                                <th>Taux</th>
                                <th>Date effet</th> -->
                               
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-plafond let-editing="editing" let-ri="rowIndex" let-expanded="expanded" >
                            <tr  class="colorZone">
                                <td>
                                    <button type="button" pButton pRipple [pRowToggler]="plafond" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                                </td>
                                <td>{{plafond.garantie?.libelle}}</td>
                                <!--
                                <td>{{plafond.montantPlafond}}</td>
                                -->
                                <td>
                                </td>
    
                                <td>{{plafond.montantPlafond | formatTableValue: 'number':true}}</td>
    
                                <td>{{plafond?.dimensionPeriode?.libelle}}</td>
    
                                <td>{{plafond.nombre | formatTableValue: 'number':true}}</td>
    
                                <td>{{plafond?.taux?.taux}} </td>
    
                                <td><span *ngFor="let d of plafond.domaine">
                                    {{d.libelle}}
                                </span></td>
    
                                <td>{{plafond.dateEffet | formatTableValue : 'date'}}</td>
    
                                <td>{{plafond?.etat}} </td>
    
                            
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="rowexpansion" let-plafond>
                             <tr >
                                <td colspan="10">
                                    <div class="">
                                        <p-table [value]="plafond.listeActe" dataKey="acte.id" editMode="row">
                                            <tr>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                
                                                
                                                
                                                
                                                
                                            </tr>
                                            <ng-template pTemplate="body" let-acte let-editing="editing" let-ri="rowIndex" let-expanded="expanded">
                                                <tr  class="colorZoneActe">
                    
                                                    <td> <button type="button" pButton pRipple [pRowToggler]="acte" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button></td>
                                                    <td>{{acte?.acte?.libelle}}</td>
                                                    
                                                    <td></td>
                                        
                                                    <td> {{acte.montantPlafond | formatTableValue: 'number':true}}</td>
                                                    
                                                    <td>{{acte?.dimensionPeriode?.libelle}}</td>
                                                    
                                                    <td>{{acte.nombre | formatTableValue: 'number':true}}</td>
                                                    
                                                    
                    
                                                    <td>{{acte?.taux?.taux}} </td>
                    
                                                    <td><span *ngFor="let d of acte.domaine"> {{d.libelle}} </span></td>
                    
                                                    <td>{{acte.dateEffet | formatTableValue : 'date'}} </td>
                    
                                                    <td>{{acte?.etat}}</td>
                                                    
                    
                                                </tr>
                                            </ng-template>
                                            <ng-template pTemplate="rowexpansion" let-acte>
                                                <tr>
                                                    <td colspan="10">
                                                        <div class="">
                                                            <p-table [value]="acte.listeSousActe" dataKey="id" editMode="row">
                                                <tr>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    
                                                    
                                                </tr>
                                                <ng-template pTemplate="body" let-sousActe let-editing="editing" let-ri="rowIndex" let-expanded="expanded">
                                                    <tr  class="colorZoneSousActe">
                                                        
                                                        <td></td>
                                                        <td>{{sousActe?.sousActe?.libelle}}</td>
                                                        <td>{{sousActe?.montantPlafondParActe | formatTableValue: 'number':true}}</td>
                                                        <td> {{sousActe.montantPlafond | formatTableValue: 'number':true}}</td>
                                                        <td>{{sousActe?.dimensionPeriode?.libelle}} </td>
                                                        <td>{{sousActe.nombre | formatTableValue: 'number':true}}</td>
                                                        <td>{{sousActe?.taux?.taux}} </td>
                                                        <td><span *ngFor="let d of sousActe.domaine"> {{d.libelle}} </span> </td>
                                                        <td>{{sousActe.dateEffet | formatTableValue : 'date'}} </td>
                                                        <td>{{sousActe?.etat}} </td>
                    
                                    
                                                    </tr>
                                                </ng-template>
                    
                    
                                        </p-table>
                                    </div>
                                </td>
                            </tr>
                       </ng-template>
                    </p-table>
                                        
                        </div>
                      </td>
                     </tr>
                    
                    </ng-template>
                    </p-table>
                </ng-template>
            </p-tabPanel>

            <p-tabPanel header="ADHERENT" leftIcon="pi pi-user-edit" tooltip="ADHERANT">
                <span style="color: green !important"> <h4> Informations portant sur liste actualisée des adherents de l'avenant</h4></span>
                
                <div class="card">
                    <p-table #dtAD [value]="avenantModif1.adhrents" [columns]="colsAL" [rows]="10" [paginator]="true"
                             [globalFilterFields]="['libelle','description','duree','territorialite.libelle']"
                             [rowHover]="true" dataKey="id" [exportFilename]="'liste actualisée'" csvSeparator=";"
                             styleClass="p-datatable-customers"
                             currentPageReportTemplate="{first} to {last} of {totalRecords} enregistrements"
                             [showCurrentPageReport]="true">
                        <ng-template pTemplate="caption">
                            <div class="table-header">
                                <h5 class="p-m-0"></h5>
                                <div class="p-grid">
                                    <div class="p-col-8">
                                <span class="p-input-icon-left">
                                    <i class="pi pi-search"></i>
                                    <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                           placeholder="Search..." [style]="{width: '20%'}"/>
                                </span>

                                    </div>
                                    <div class="p-col-2">
                                        <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                            <button pButton pRipple label="Exporter" icon="pi pi-upload" class="p-button-help"
                                                    (click)="dtAD.exportCSV()"></button>
                                        </div>
                                    </div>
                                    <div class="p-col-2">
                                        <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                                            <button pButton pRipple label="Imprimer" icon="pi pi-print" class="p-button-info">

                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template pTemplate="header">
                            <tr>
                                <th pSortableColumn="numero" style="font-size: 12px !important; font-weight: bold;">Matricule
                                    <p-sortIcon field="numero"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroGarant" style=" font-size: 12px !important; font-weight: bold;">Matricule Garant
                                    <p-sortIcon field="numeroGarant"></p-sortIcon>
                                </th>
                                <th pSortableColumn="nom">Nom
                                    <p-sortIcon field="nom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="prenom" style="width: 12rem">Prenom
                                    <p-sortIcon field="prenom"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresseEmail">Date de naissance
                                    <p-sortIcon field="dateNaissance"></p-sortIcon>
                                </th>
                                <th pSortableColumn="adresseEmail">Email
                                    <p-sortIcon field="adresseEmail"></p-sortIcon>
                                </th>
                                <th pSortableColumn="numeroTelephone">Téléphone
                                    <p-sortIcon field="numeroTelephone"></p-sortIcon>
                                </th>
                                <th pSortableColumn="genre" style="width: 12rem">Genre
                                    <p-sortIcon field="genre.libelle"></p-sortIcon>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-adherent>
                            <tr [ngClass]="{'colorZone': !adherent?.adherentPrincipal}">
                                <td><span class="p-column-title">{{adherent.numero}}</span></td>
                                <td><span class="p-column-title">{{adherent.matriculeGarant}}</span></td>
                                <td><span class="p-column-title">{{adherent?.nom}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.prenom}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.dateNaissance}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.email}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.numeroTelephone}}</span>

                                </td>
                                <td><span class="p-column-title">{{adherent?.genre?.libelle}}</span></td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            <div class="p-d-flex p-ai-center p-jc-between">
                                {{avenantModif1.adhrents ? avenantModif1.adhrents.length : 0 }} adherent(s).
                            </div>
                        </ng-template>
                    </p-table>
                </div>


                <div class="p-col-12">

                </div>
            </p-tabPanel>
        </p-tabView>
    </p-dialog>

</div>
